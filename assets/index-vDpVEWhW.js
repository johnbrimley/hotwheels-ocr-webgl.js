(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();const ds=!1;var _r=Array.isArray,wu=Array.prototype.indexOf,vr=Array.from,Iu=Object.defineProperty,At=Object.getOwnPropertyDescriptor,pa=Object.getOwnPropertyDescriptors,Pu=Object.prototype,Bu=Array.prototype,Ps=Object.getPrototypeOf,Fi=Object.isExtensible;function Cu(e){return typeof e=="function"}const In=()=>{};function Du(e){return e()}function hs(e){for(var t=0;t<e.length;t++)e[t]()}function xa(){var e,t,n=new Promise((r,s)=>{e=r,t=s});return{promise:n,resolve:e,reject:t}}const te=2,Bs=4,pr=8,Mu=1<<24,Ue=16,et=32,Dt=64,xr=128,Ae=512,J=1024,he=2048,Te=4096,ve=8192,je=16384,br=32768,ft=65536,wi=1<<17,ba=1<<18,dn=1<<19,ga=1<<20,We=1<<25,It=32768,ms=1<<21,Cs=1<<22,ot=1<<23,Qe=Symbol("$state"),Nu=Symbol("legacy props"),ku=Symbol(""),tn=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Ds(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Gu(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Lu(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Uu(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Ou(e){throw new Error("https://svelte.dev/e/effect_orphan")}function Vu(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Hu(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function zu(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Xu(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function $u(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function qu(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Yu=1,Ku=2,Ea=4,Wu=8,ju=16,Qu=1,Zu=2,Ju=4,ec=8,tc=16,nc=4,rc=2,se=Symbol(),sc="http://www.w3.org/1999/xhtml";function ic(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function oc(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function ya(e){return e===this.v}function ac(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function Ra(e){return!ac(e,this.v)}let hn=!1,lc=!1;function uc(){hn=!0}let $=null;function ln(e){$=e}function pe(e,t=!1,n){$={p:$,i:!1,c:null,e:null,s:e,x:null,l:hn&&!t?{s:null,u:null,$:[]}:null}}function xe(e){var t=$,n=t.e;if(n!==null){t.e=null;for(var r of n)ka(r)}return e!==void 0&&(t.x=e),t.i=!0,$=t.p,e??{}}function Hn(){return!hn||$!==null&&$.l===null}let nn=[];function cc(){var e=nn;nn=[],hs(e)}function Mt(e){if(nn.length===0){var t=nn;queueMicrotask(()=>{t===nn&&cc()})}nn.push(e)}function Sa(e){var t=O;if(t===null)return G.f|=ot,e;if((t.f&br)===0){if((t.f&xr)===0)throw e;t.b.error(e)}else un(e,t)}function un(e,t){for(;t!==null;){if((t.f&xr)!==0)try{t.b.error(e);return}catch(n){e=n}t=t.parent}throw e}const Yn=new Set;let z=null,tr=null,ye=null,Be=[],Ms=null,_s=!1;class Ce{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#r=0;#n=0;#l=null;#i=new Set;#s=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#n>0}process(t){Be=[],tr=null,this.apply();var n={parent:null,effect:null,effects:[],render_effects:[]};for(const r of t)this.#o(r,n);this.is_fork||this.#c(),this.is_deferred()?(this.#a(n.effects),this.#a(n.render_effects)):(tr=this,z=null,Ii(n.render_effects),Ii(n.effects),tr=null,this.#l?.resolve()),ye=null}#o(t,n){t.f^=J;for(var r=t.first;r!==null;){var s=r.f,i=(s&(et|Dt))!==0,a=i&&(s&J)!==0,o=a||(s&ve)!==0||this.skipped_effects.has(r);if((r.f&xr)!==0&&r.b?.is_pending()&&(n={parent:n,effect:r,effects:[],render_effects:[]}),!o&&r.fn!==null){i?r.f^=J:(s&Bs)!==0?n.effects.push(r):_n(r)&&((r.f&Ue)!==0&&this.#i.add(r),cn(r));var l=r.first;if(l!==null){r=l;continue}}var u=r.parent;for(r=r.next;r===null&&u!==null;)u===n.effect&&(this.#a(n.effects),this.#a(n.render_effects),n=n.parent),r=u.next,u=u.parent}}#a(t){for(const n of t)(n.f&he)!==0?this.#i.add(n):(n.f&Te)!==0&&this.#s.add(n),this.#u(n.deps),ee(n,J)}#u(t){if(t!==null)for(const n of t)(n.f&te)===0||(n.f&It)===0||(n.f^=It,this.#u(n.deps))}capture(t,n){this.previous.has(t)||this.previous.set(t,n),(t.f&ot)===0&&(this.current.set(t,t.v),ye?.set(t,t.v))}activate(){z=this,this.apply()}deactivate(){z===this&&(z=null,ye=null)}flush(){if(this.activate(),Be.length>0){if(fc(),z!==null&&z!==this)return}else this.#r===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#t)t(this);this.#t.clear()}#c(){if(this.#n===0){for(const t of this.#e)t();this.#e.clear()}this.#r===0&&this.#f()}#f(){if(Yn.size>1){this.previous.clear();var t=ye,n=!0,r={parent:null,effect:null,effects:[],render_effects:[]};for(const i of Yn){if(i===this){n=!1;continue}const a=[];for(const[l,u]of this.current){if(i.current.has(l))if(n&&u!==i.current.get(l))i.current.set(l,u);else continue;a.push(l)}if(a.length===0)continue;const o=[...i.current.keys()].filter(l=>!this.current.has(l));if(o.length>0){var s=Be;Be=[];const l=new Set,u=new Map;for(const f of a)Aa(f,o,l,u);if(Be.length>0){z=i,i.apply();for(const f of Be)i.#o(f,r);i.deactivate()}Be=s}}z=null,ye=t}this.committed=!0,Yn.delete(this)}increment(t){this.#r+=1,t&&(this.#n+=1)}decrement(t){this.#r-=1,t&&(this.#n-=1),this.revive()}revive(){for(const t of this.#i)this.#s.delete(t),ee(t,he),Pt(t);for(const t of this.#s)ee(t,Te),Pt(t);this.flush()}oncommit(t){this.#e.add(t)}ondiscard(t){this.#t.add(t)}settled(){return(this.#l??=xa()).promise}static ensure(){if(z===null){const t=z=new Ce;Yn.add(z),Ce.enqueue(()=>{z===t&&t.flush()})}return z}static enqueue(t){Mt(t)}apply(){}}function fc(){var e=Ft;_s=!0;var t=null;try{var n=0;for(ar(!0);Be.length>0;){var r=Ce.ensure();if(n++>1e3){var s,i;dc()}r.process(Be),at.clear()}}finally{_s=!1,ar(e),Ms=null}}function dc(){try{Vu()}catch(e){un(e,Ms)}}let Ye=null;function Ii(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var r=e[n++];if((r.f&(je|ve))===0&&_n(r)&&(Ye=new Set,cn(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?Ua(r):r.fn=null),Ye?.size>0)){at.clear();for(const s of Ye){if((s.f&(je|ve))!==0)continue;const i=[s];let a=s.parent;for(;a!==null;)Ye.has(a)&&(Ye.delete(a),i.push(a)),a=a.parent;for(let o=i.length-1;o>=0;o--){const l=i[o];(l.f&(je|ve))===0&&cn(l)}}Ye.clear()}}Ye=null}}function Aa(e,t,n,r){if(!n.has(e)&&(n.add(e),e.reactions!==null))for(const s of e.reactions){const i=s.f;(i&te)!==0?Aa(s,t,n,r):(i&(Cs|Ue))!==0&&(i&he)===0&&Ta(s,t,r)&&(ee(s,he),Pt(s))}}function Ta(e,t,n){const r=n.get(e);if(r!==void 0)return r;if(e.deps!==null)for(const s of e.deps){if(t.includes(s))return!0;if((s.f&te)!==0&&Ta(s,t,n))return n.set(s,!0),!0}return n.set(e,!1),!1}function Pt(e){for(var t=Ms=e;t.parent!==null;){t=t.parent;var n=t.f;if(_s&&t===O&&(n&Ue)!==0&&(n&ba)===0)return;if((n&(Dt|et))!==0){if((n&J)===0)return;t.f^=J}}Be.push(t)}function hc(e){let t=0,n=Bt(0),r;return()=>{Gn()&&(p(n),yr(()=>(t===0&&(r=Fe(()=>e(()=>Nn(n)))),t+=1,()=>{Mt(()=>{t-=1,t===0&&(r?.(),r=void 0,Nn(n))})})))}}var mc=ft|dn|xr;function _c(e,t,n){new vc(e,t,n)}class vc{parent;#e=!1;#t;#r=null;#n;#l;#i;#s=null;#o=null;#a=null;#u=null;#c=null;#f=0;#d=0;#m=!1;#h=null;#b=hc(()=>(this.#h=Bt(this.#f),()=>{this.#h=null}));constructor(t,n,r){this.#t=t,this.#n=n,this.#l=r,this.parent=O.b,this.#e=!!this.#n.pending,this.#i=Rr(()=>{O.b=this;{var s=this.#p();try{this.#s=Ee(()=>r(s))}catch(i){this.error(i)}this.#d>0?this.#v():this.#e=!1}return()=>{this.#c?.remove()}},mc)}#g(){try{this.#s=Ee(()=>this.#l(this.#t))}catch(t){this.error(t)}this.#e=!1}#E(){const t=this.#n.pending;t&&(this.#o=Ee(()=>t(this.#t)),Ce.enqueue(()=>{var n=this.#p();this.#s=this.#_(()=>(Ce.ensure(),Ee(()=>this.#l(n)))),this.#d>0?this.#v():(Tt(this.#o,()=>{this.#o=null}),this.#e=!1)}))}#p(){var t=this.#t;return this.#e&&(this.#c=lt(),this.#t.before(this.#c),t=this.#c),t}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#n.pending}#_(t){var n=O,r=G,s=$;Ne(this.#i),fe(this.#i),ln(this.#i.ctx);try{return t()}catch(i){return Sa(i),null}finally{Ne(n),fe(r),ln(s)}}#v(){const t=this.#n.pending;this.#s!==null&&(this.#u=document.createDocumentFragment(),this.#u.append(this.#c),Ha(this.#s,this.#u)),this.#o===null&&(this.#o=Ee(()=>t(this.#t)))}#x(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#x(t);return}this.#d+=t,this.#d===0&&(this.#e=!1,this.#o&&Tt(this.#o,()=>{this.#o=null}),this.#u&&(this.#t.before(this.#u),this.#u=null))}update_pending_count(t){this.#x(t),this.#f+=t,this.#h&&Ct(this.#h,this.#f)}get_effect_pending(){return this.#b(),p(this.#h)}error(t){var n=this.#n.onerror;let r=this.#n.failed;if(this.#m||!n&&!r)throw t;this.#s&&(de(this.#s),this.#s=null),this.#o&&(de(this.#o),this.#o=null),this.#a&&(de(this.#a),this.#a=null);var s=!1,i=!1;const a=()=>{if(s){oc();return}s=!0,i&&qu(),Ce.ensure(),this.#f=0,this.#a!==null&&Tt(this.#a,()=>{this.#a=null}),this.#e=this.has_pending_snippet(),this.#s=this.#_(()=>(this.#m=!1,Ee(()=>this.#l(this.#t)))),this.#d>0?this.#v():this.#e=!1};var o=G;try{fe(null),i=!0,n?.(t,a),i=!1}catch(l){un(l,this.#i&&this.#i.parent)}finally{fe(o)}r&&Mt(()=>{this.#a=this.#_(()=>{Ce.ensure(),this.#m=!0;try{return Ee(()=>{r(this.#t,()=>t,()=>a)})}catch(l){return un(l,this.#i.parent),null}finally{this.#m=!1}})})}}function pc(e,t,n,r){const s=Hn()?gr:st;if(n.length===0&&e.length===0){r(t.map(s));return}var i=z,a=O,o=xc();function l(){Promise.all(n.map(u=>bc(u))).then(u=>{o();try{r([...t.map(s),...u])}catch(f){(a.f&je)===0&&un(f,a)}i?.deactivate(),or()}).catch(u=>{un(u,a)})}e.length>0?Promise.all(e).then(()=>{o();try{return l()}finally{i?.deactivate(),or()}}):l()}function xc(){var e=O,t=G,n=$,r=z;return function(i=!0){Ne(e),fe(t),ln(n),i&&r?.activate()}}function or(){Ne(null),fe(null),ln(null)}function gr(e){var t=te|he,n=G!==null&&(G.f&te)!==0?G:null;return O!==null&&(O.f|=dn),{ctx:$,deps:null,effects:null,equals:ya,f:t,fn:e,reactions:null,rv:0,v:se,wv:0,parent:n??O,ac:null}}function bc(e,t){let n=O;n===null&&Gu();var r=n.b,s=void 0,i=Bt(se),a=!G,o=new Map;return Pc(()=>{var l=xa();s=l.promise;try{Promise.resolve(e()).then(l.resolve,l.reject).then(()=>{u===z&&u.committed&&u.deactivate(),or()})}catch(c){l.reject(c),or()}var u=z;if(a){var f=!r.is_pending();r.update_pending_count(1),u.increment(f),o.get(u)?.reject(tn),o.delete(u),o.set(u,l)}const h=(c,d=void 0)=>{if(u.activate(),d)d!==tn&&(i.f|=ot,Ct(i,d));else{(i.f&ot)!==0&&(i.f^=ot),Ct(i,c);for(const[m,_]of o){if(o.delete(m),m===u)break;_.reject(tn)}}a&&(r.update_pending_count(-1),u.decrement(f))};l.promise.then(h,c=>h(null,c||"unknown"))}),Er(()=>{for(const l of o.values())l.reject(tn)}),new Promise(l=>{function u(f){function h(){f===s?l(i):u(s)}f.then(h,h)}u(s)})}function st(e){const t=gr(e);return t.equals=Ra,t}function Fa(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)de(t[n])}}function gc(e){for(var t=e.parent;t!==null;){if((t.f&te)===0)return(t.f&je)===0?t:null;t=t.parent}return null}function Ns(e){var t,n=O;Ne(gc(e));try{e.f&=~It,Fa(e),t=qa(e)}finally{Ne(n)}return t}function wa(e){var t=Ns(e);if(e.equals(t)||(z?.is_fork||(e.v=t),e.wv=Xa()),!Gt)if(ye!==null)(Gn()||z?.is_fork)&&ye.set(e,t);else{var n=(e.f&Ae)===0?Te:J;ee(e,n)}}let vs=new Set;const at=new Map;let Ia=!1;function Bt(e,t){var n={f:0,v:e,reactions:null,equals:ya,rv:0,wv:0};return n}function tt(e,t){const n=Bt(e);return Mc(n),n}function N(e,t=!1,n=!0){const r=Bt(e);return t||(r.equals=Ra),hn&&n&&$!==null&&$.l!==null&&($.l.s??=[]).push(r),r}function S(e,t,n=!1){G!==null&&(!De||(G.f&wi)!==0)&&Hn()&&(G.f&(te|Ue|Cs|wi))!==0&&!Ze?.includes(e)&&$u();let r=n?rn(t):t;return Ct(e,r)}function Ct(e,t){if(!e.equals(t)){var n=e.v;Gt?at.set(e,t):at.set(e,n),e.v=t;var r=Ce.ensure();r.capture(e,n),(e.f&te)!==0&&((e.f&he)!==0&&Ns(e),ee(e,(e.f&Ae)!==0?J:Te)),e.wv=Xa(),Pa(e,he),Hn()&&O!==null&&(O.f&J)!==0&&(O.f&(et|Dt))===0&&(ge===null?Nc([e]):ge.push(e)),!r.is_fork&&vs.size>0&&!Ia&&Ec()}return t}function Ec(){Ia=!1;var e=Ft;ar(!0);const t=Array.from(vs);try{for(const n of t)(n.f&J)!==0&&ee(n,Te),_n(n)&&cn(n)}finally{ar(e)}vs.clear()}function Nn(e){S(e,e.v+1)}function Pa(e,t){var n=e.reactions;if(n!==null)for(var r=Hn(),s=n.length,i=0;i<s;i++){var a=n[i],o=a.f;if(!(!r&&a===O)){var l=(o&he)===0;if(l&&ee(a,t),(o&te)!==0){var u=a;ye?.delete(u),(o&It)===0&&(o&Ae&&(a.f|=It),Pa(u,Te))}else l&&((o&Ue)!==0&&Ye!==null&&Ye.add(a),Pt(a))}}}function rn(e){if(typeof e!="object"||e===null||Qe in e)return e;const t=Ps(e);if(t!==Pu&&t!==Bu)return e;var n=new Map,r=_r(e),s=tt(0),i=wt,a=o=>{if(wt===i)return o();var l=G,u=wt;fe(null),Ni(i);var f=o();return fe(l),Ni(u),f};return r&&n.set("length",tt(e.length)),new Proxy(e,{defineProperty(o,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&zu();var f=n.get(l);return f===void 0?f=a(()=>{var h=tt(u.value);return n.set(l,h),h}):S(f,u.value,!0),!0},deleteProperty(o,l){var u=n.get(l);if(u===void 0){if(l in o){const f=a(()=>tt(se));n.set(l,f),Nn(s)}}else S(u,se),Nn(s);return!0},get(o,l,u){if(l===Qe)return e;var f=n.get(l),h=l in o;if(f===void 0&&(!h||At(o,l)?.writable)&&(f=a(()=>{var d=rn(h?o[l]:se),m=tt(d);return m}),n.set(l,f)),f!==void 0){var c=p(f);return c===se?void 0:c}return Reflect.get(o,l,u)},getOwnPropertyDescriptor(o,l){var u=Reflect.getOwnPropertyDescriptor(o,l);if(u&&"value"in u){var f=n.get(l);f&&(u.value=p(f))}else if(u===void 0){var h=n.get(l),c=h?.v;if(h!==void 0&&c!==se)return{enumerable:!0,configurable:!0,value:c,writable:!0}}return u},has(o,l){if(l===Qe)return!0;var u=n.get(l),f=u!==void 0&&u.v!==se||Reflect.has(o,l);if(u!==void 0||O!==null&&(!f||At(o,l)?.writable)){u===void 0&&(u=a(()=>{var c=f?rn(o[l]):se,d=tt(c);return d}),n.set(l,u));var h=p(u);if(h===se)return!1}return f},set(o,l,u,f){var h=n.get(l),c=l in o;if(r&&l==="length")for(var d=u;d<h.v;d+=1){var m=n.get(d+"");m!==void 0?S(m,se):d in o&&(m=a(()=>tt(se)),n.set(d+"",m))}if(h===void 0)(!c||At(o,l)?.writable)&&(h=a(()=>tt(void 0)),S(h,rn(u)),n.set(l,h));else{c=h.v!==se;var _=a(()=>rn(u));S(h,_)}var v=Reflect.getOwnPropertyDescriptor(o,l);if(v?.set&&v.set.call(f,u),!c){if(r&&typeof l=="string"){var x=n.get("length"),E=Number(l);Number.isInteger(E)&&E>=x.v&&S(x,E+1)}Nn(s)}return!0},ownKeys(o){p(s);var l=Reflect.ownKeys(o).filter(h=>{var c=n.get(h);return c===void 0||c.v!==se});for(var[u,f]of n)f.v!==se&&!(u in o)&&l.push(u);return l},setPrototypeOf(){Xu()}})}function Pi(e){try{if(e!==null&&typeof e=="object"&&Qe in e)return e[Qe]}catch{}return e}function yc(e,t){return Object.is(Pi(e),Pi(t))}var Bi,Ba,Ca,Da;function Rc(){if(Bi===void 0){Bi=window,Ba=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;Ca=At(t,"firstChild").get,Da=At(t,"nextSibling").get,Fi(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Fi(n)&&(n.__t=void 0)}}function lt(e=""){return document.createTextNode(e)}function ks(e){return Ca.call(e)}function zn(e){return Da.call(e)}function U(e,t){return ks(e)}function oe(e,t=!1){{var n=ks(e);return n instanceof Comment&&n.data===""?zn(n):n}}function V(e,t=1,n=!1){let r=e;for(;t--;)r=zn(r);return r}function Sc(e){e.textContent=""}function Ma(){return!1}let Ci=!1;function Ac(){Ci||(Ci=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function mn(e){var t=G,n=O;fe(null),Ne(null);try{return e()}finally{fe(t),Ne(n)}}function Tc(e,t,n,r=n){e.addEventListener(t,()=>mn(n));const s=e.__on_r;s?e.__on_r=()=>{s(),r(!0)}:e.__on_r=()=>r(!0),Ac()}function Na(e){O===null&&(G===null&&Ou(),Uu()),Gt&&Lu()}function Fc(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function Oe(e,t,n){var r=O;r!==null&&(r.f&ve)!==0&&(e|=ve);var s={ctx:$,deps:null,nodes:null,f:e|he|Ae,first:null,fn:t,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(n)try{cn(s),s.f|=br}catch(o){throw de(s),o}else t!==null&&Pt(s);var i=s;if(n&&i.deps===null&&i.teardown===null&&i.nodes===null&&i.first===i.last&&(i.f&dn)===0&&(i=i.first,(e&Ue)!==0&&(e&ft)!==0&&i!==null&&(i.f|=ft)),i!==null&&(i.parent=r,r!==null&&Fc(i,r),G!==null&&(G.f&te)!==0&&(e&Dt)===0)){var a=G;(a.effects??=[]).push(i)}return s}function Gn(){return G!==null&&!De}function Er(e){const t=Oe(pr,null,!1);return ee(t,J),t.teardown=e,t}function ps(e){Na();var t=O.f,n=!G&&(t&et)!==0&&(t&br)===0;if(n){var r=$;(r.e??=[]).push(e)}else return ka(e)}function ka(e){return Oe(Bs|ga,e,!1)}function wc(e){return Na(),Oe(pr|ga,e,!0)}function Ic(e){Ce.ensure();const t=Oe(Dt|dn,e,!0);return(n={})=>new Promise(r=>{n.outro?Tt(t,()=>{de(t),r(void 0)}):(de(t),r(void 0))})}function Gs(e){return Oe(Bs,e,!1)}function Nt(e,t){var n=$,r={effect:null,ran:!1,deps:e};n.l.$.push(r),r.effect=yr(()=>{e(),!r.ran&&(r.ran=!0,Fe(t))})}function kt(){var e=$;yr(()=>{for(var t of e.l.$){t.deps();var n=t.effect;(n.f&J)!==0&&ee(n,Te),_n(n)&&cn(n),t.ran=!1}})}function Pc(e){return Oe(Cs|dn,e,!0)}function yr(e,t=0){return Oe(pr|t,e,!0)}function Se(e,t=[],n=[],r=[]){pc(r,t,n,s=>{Oe(pr,()=>e(...s.map(p)),!0)})}function Rr(e,t=0){var n=Oe(Ue|t,e,!0);return n}function Ee(e){return Oe(et|dn,e,!0)}function Ga(e){var t=e.teardown;if(t!==null){const n=Gt,r=G;Mi(!0),fe(null);try{t.call(null)}finally{Mi(n),fe(r)}}}function La(e,t=!1){var n=e.first;for(e.first=e.last=null;n!==null;){const s=n.ac;s!==null&&mn(()=>{s.abort(tn)});var r=n.next;(n.f&Dt)!==0?n.parent=null:de(n,t),n=r}}function Bc(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&et)===0&&de(t),t=n}}function de(e,t=!0){var n=!1;(t||(e.f&ba)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(Cc(e.nodes.start,e.nodes.end),n=!0),La(e,t&&!n),lr(e,0),ee(e,je);var r=e.nodes&&e.nodes.t;if(r!==null)for(const i of r)i.stop();Ga(e);var s=e.parent;s!==null&&s.first!==null&&Ua(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function Cc(e,t){for(;e!==null;){var n=e===t?null:zn(e);e.remove(),e=n}}function Ua(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function Tt(e,t,n=!0){var r=[];Oa(e,r,!0);var s=()=>{n&&de(e),t&&t()},i=r.length;if(i>0){var a=()=>--i||s();for(var o of r)o.out(a)}else s()}function Oa(e,t,n){if((e.f&ve)===0){e.f^=ve;var r=e.nodes&&e.nodes.t;if(r!==null)for(const o of r)(o.is_global||n)&&t.push(o);for(var s=e.first;s!==null;){var i=s.next,a=(s.f&ft)!==0||(s.f&et)!==0&&(e.f&Ue)!==0;Oa(s,t,a?n:!1),s=i}}}function Ls(e){Va(e,!0)}function Va(e,t){if((e.f&ve)!==0){e.f^=ve,(e.f&J)===0&&(ee(e,he),Pt(e));for(var n=e.first;n!==null;){var r=n.next,s=(n.f&ft)!==0||(n.f&et)!==0;Va(n,s?t:!1),n=r}var i=e.nodes&&e.nodes.t;if(i!==null)for(const a of i)(a.is_global||t)&&a.in()}}function Ha(e,t){if(e.nodes)for(var n=e.nodes.start,r=e.nodes.end;n!==null;){var s=n===r?null:zn(n);t.append(n),n=s}}let en=null;function Dc(e){var t=en;try{if(en=new Set,Fe(e),t!==null)for(var n of en)t.add(n);return en}finally{en=t}}function Di(e){for(var t of Dc(e))Ct(t,t.v)}let Ft=!1;function ar(e){Ft=e}let Gt=!1;function Mi(e){Gt=e}let G=null,De=!1;function fe(e){G=e}let O=null;function Ne(e){O=e}let Ze=null;function Mc(e){G!==null&&(Ze===null?Ze=[e]:Ze.push(e))}let le=null,_e=0,ge=null;function Nc(e){ge=e}let za=1,Ln=0,wt=Ln;function Ni(e){wt=e}function Xa(){return++za}function _n(e){var t=e.f;if((t&he)!==0)return!0;if(t&te&&(e.f&=~It),(t&Te)!==0){var n=e.deps;if(n!==null)for(var r=n.length,s=0;s<r;s++){var i=n[s];if(_n(i)&&wa(i),i.wv>e.wv)return!0}(t&Ae)!==0&&ye===null&&ee(e,J)}return!1}function $a(e,t,n=!0){var r=e.reactions;if(r!==null&&!Ze?.includes(e))for(var s=0;s<r.length;s++){var i=r[s];(i.f&te)!==0?$a(i,t,!1):t===i&&(n?ee(i,he):(i.f&J)!==0&&ee(i,Te),Pt(i))}}function qa(e){var t=le,n=_e,r=ge,s=G,i=Ze,a=$,o=De,l=wt,u=e.f;le=null,_e=0,ge=null,G=(u&(et|Dt))===0?e:null,Ze=null,ln(e.ctx),De=!1,wt=++Ln,e.ac!==null&&(mn(()=>{e.ac.abort(tn)}),e.ac=null);try{e.f|=ms;var f=e.fn,h=f(),c=e.deps;if(le!==null){var d;if(lr(e,_e),c!==null&&_e>0)for(c.length=_e+le.length,d=0;d<le.length;d++)c[_e+d]=le[d];else e.deps=c=le;if(Gn()&&(e.f&Ae)!==0)for(d=_e;d<c.length;d++)(c[d].reactions??=[]).push(e)}else c!==null&&_e<c.length&&(lr(e,_e),c.length=_e);if(Hn()&&ge!==null&&!De&&c!==null&&(e.f&(te|Te|he))===0)for(d=0;d<ge.length;d++)$a(ge[d],e);return s!==null&&s!==e&&(Ln++,ge!==null&&(r===null?r=ge:r.push(...ge))),(e.f&ot)!==0&&(e.f^=ot),h}catch(m){return Sa(m)}finally{e.f^=ms,le=t,_e=n,ge=r,G=s,Ze=i,ln(a),De=o,wt=l}}function kc(e,t){let n=t.reactions;if(n!==null){var r=wu.call(n,e);if(r!==-1){var s=n.length-1;s===0?n=t.reactions=null:(n[r]=n[s],n.pop())}}n===null&&(t.f&te)!==0&&(le===null||!le.includes(t))&&(ee(t,Te),(t.f&Ae)!==0&&(t.f^=Ae,t.f&=~It),Fa(t),lr(t,0))}function lr(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)kc(e,n[r])}function cn(e){var t=e.f;if((t&je)===0){ee(e,J);var n=O,r=Ft;O=e,Ft=!0;try{(t&(Ue|Mu))!==0?Bc(e):La(e),Ga(e);var s=qa(e);e.teardown=typeof s=="function"?s:null,e.wv=za;var i;ds&&lc&&(e.f&he)!==0&&e.deps}finally{Ft=r,O=n}}}function p(e){var t=e.f,n=(t&te)!==0;if(en?.add(e),G!==null&&!De){var r=O!==null&&(O.f&je)!==0;if(!r&&!Ze?.includes(e)){var s=G.deps;if((G.f&ms)!==0)e.rv<Ln&&(e.rv=Ln,le===null&&s!==null&&s[_e]===e?_e++:le===null?le=[e]:le.includes(e)||le.push(e));else{(G.deps??=[]).push(e);var i=e.reactions;i===null?e.reactions=[G]:i.includes(G)||i.push(G)}}}if(Gt){if(at.has(e))return at.get(e);if(n){var a=e,o=a.v;return((a.f&J)===0&&a.reactions!==null||Ka(a))&&(o=Ns(a)),at.set(a,o),o}}else n&&(!ye?.has(e)||z?.is_fork&&!Gn())&&(a=e,_n(a)&&wa(a),Ft&&Gn()&&(a.f&Ae)===0&&Ya(a));if(ye?.has(e))return ye.get(e);if((e.f&ot)!==0)throw e.v;return e.v}function Ya(e){if(e.deps!==null){e.f^=Ae;for(const t of e.deps)(t.reactions??=[]).push(e),(t.f&te)!==0&&(t.f&Ae)===0&&Ya(t)}}function Ka(e){if(e.v===se)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(at.has(t)||(t.f&te)!==0&&Ka(t))return!0;return!1}function Fe(e){var t=De;try{return De=!0,e()}finally{De=t}}const Gc=-7169;function ee(e,t){e.f=e.f&Gc|t}function ke(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(Qe in e)xs(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];typeof n=="object"&&n&&Qe in n&&xs(n)}}}function xs(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let r in e)try{xs(e[r],t)}catch{}const n=Ps(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=pa(n);for(let s in r){const i=r[s].get;if(i)try{i.call(e)}catch{}}}}}const Lc=["touchstart","touchmove"];function Uc(e){return Lc.includes(e)}const Oc=new Set,ki=new Set;function Vc(e,t,n,r={}){function s(i){if(r.capture||Dn.call(t,i),!i.cancelBubble)return mn(()=>n?.call(this,i))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Mt(()=>{t.addEventListener(e,s,r)}):t.addEventListener(e,s,r),s}function sn(e,t,n,r,s){var i={capture:r,passive:s},a=Vc(e,t,n,i);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&Er(()=>{t.removeEventListener(e,a,i)})}let Gi=null;function Dn(e){var t=this,n=t.ownerDocument,r=e.type,s=e.composedPath?.()||[],i=s[0]||e.target;Gi=e;var a=0,o=Gi===e&&e.__root;if(o){var l=s.indexOf(o);if(l!==-1&&(t===document||t===window)){e.__root=t;return}var u=s.indexOf(t);if(u===-1)return;l<=u&&(a=l)}if(i=s[a]||e.target,i!==t){Iu(e,"currentTarget",{configurable:!0,get(){return i||n}});var f=G,h=O;fe(null),Ne(null);try{for(var c,d=[];i!==null;){var m=i.assignedSlot||i.parentNode||i.host||null;try{var _=i["__"+r];_!=null&&(!i.disabled||e.target===i)&&_.call(i,e)}catch(v){c?d.push(v):c=v}if(e.cancelBubble||m===t||m===null)break;i=m}if(c){for(let v of d)queueMicrotask(()=>{throw v});throw c}}finally{e.__root=t,delete e.currentTarget,fe(f),Ne(h)}}}function Hc(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Wa(e,t){var n=O;n.nodes===null&&(n.nodes={start:e,end:t,a:null,t:null})}function ne(e,t){var n=(t&rc)!==0,r,s=!e.startsWith("<!>");return()=>{r===void 0&&(r=Hc(s?e:"<!>"+e),r=ks(r));var i=n||Ba?document.importNode(r,!0):r.cloneNode(!0);return Wa(i,i),i}}function ae(){var e=document.createDocumentFragment(),t=document.createComment(""),n=lt();return e.append(t,n),Wa(t,n),e}function L(e,t){e!==null&&e.before(t)}let bs=!0;function Je(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}function zc(e,t){return Xc(e,t)}const Wt=new Map;function Xc(e,{target:t,anchor:n,props:r={},events:s,context:i,intro:a=!0}){Rc();var o=new Set,l=h=>{for(var c=0;c<h.length;c++){var d=h[c];if(!o.has(d)){o.add(d);var m=Uc(d);t.addEventListener(d,Dn,{passive:m});var _=Wt.get(d);_===void 0?(document.addEventListener(d,Dn,{passive:m}),Wt.set(d,1)):Wt.set(d,_+1)}}};l(vr(Oc)),ki.add(l);var u=void 0,f=Ic(()=>{var h=n??t.appendChild(lt());return _c(h,{pending:()=>{}},c=>{if(i){pe({});var d=$;d.c=i}s&&(r.$$events=s),bs=a,u=e(c,r)||{},bs=!0,i&&xe()}),()=>{for(var c of o){t.removeEventListener(c,Dn);var d=Wt.get(c);--d===0?(document.removeEventListener(c,Dn),Wt.delete(c)):Wt.set(c,d)}ki.delete(l),h!==n&&h.parentNode?.removeChild(h)}});return $c.set(u,f),u}let $c=new WeakMap;class ja{anchor;#e=new Map;#t=new Map;#r=new Map;#n=new Set;#l=!0;constructor(t,n=!0){this.anchor=t,this.#l=n}#i=()=>{var t=z;if(this.#e.has(t)){var n=this.#e.get(t),r=this.#t.get(n);if(r)Ls(r),this.#n.delete(n);else{var s=this.#r.get(n);s&&(this.#t.set(n,s.effect),this.#r.delete(n),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),r=s.effect)}for(const[i,a]of this.#e){if(this.#e.delete(i),i===t)break;const o=this.#r.get(a);o&&(de(o.effect),this.#r.delete(a))}for(const[i,a]of this.#t){if(i===n||this.#n.has(i))continue;const o=()=>{if(Array.from(this.#e.values()).includes(i)){var u=document.createDocumentFragment();Ha(a,u),u.append(lt()),this.#r.set(i,{effect:a,fragment:u})}else de(a);this.#n.delete(i),this.#t.delete(i)};this.#l||!r?(this.#n.add(i),Tt(a,o,!1)):o()}}};#s=t=>{this.#e.delete(t);const n=Array.from(this.#e.values());for(const[r,s]of this.#r)n.includes(r)||(de(s.effect),this.#r.delete(r))};ensure(t,n){var r=z,s=Ma();if(n&&!this.#t.has(t)&&!this.#r.has(t))if(s){var i=document.createDocumentFragment(),a=lt();i.append(a),this.#r.set(t,{effect:Ee(()=>n(a)),fragment:i})}else this.#t.set(t,Ee(()=>n(this.anchor)));if(this.#e.set(r,t),s){for(const[o,l]of this.#t)o===t?r.skipped_effects.delete(l):r.skipped_effects.add(l);for(const[o,l]of this.#r)o===t?r.skipped_effects.delete(l.effect):r.skipped_effects.add(l.effect);r.oncommit(this.#i),r.ondiscard(this.#s)}else this.#i()}}function ie(e,t,n=!1){var r=new ja(e),s=n?ft:0;function i(a,o){r.ensure(a,o)}Rr(()=>{var a=!1;t((o,l=!0)=>{a=!0,i(l,o)}),a||i(!1,null)},s)}function qc(e,t,n){for(var r=[],s=t.length,i,a=t.length,o=0;o<s;o++){let h=t[o];Tt(h,()=>{if(i){if(i.pending.delete(h),i.done.add(h),i.pending.size===0){var c=e.outrogroups;gs(vr(i.done)),c.delete(i),c.size===0&&(e.outrogroups=null)}}else a-=1},!1)}if(a===0){var l=r.length===0&&n!==null;if(l){var u=n,f=u.parentNode;Sc(f),f.append(u),e.items.clear()}gs(t,!l)}else i={pending:new Set(t),done:new Set},(e.outrogroups??=new Set).add(i)}function gs(e,t=!0){for(var n=0;n<e.length;n++)de(e[n],t)}var Li;function Es(e,t,n,r,s,i=null){var a=e,o=new Map,l=(t&Ea)!==0;if(l){var u=e;a=u.appendChild(lt())}var f=null,h=st(()=>{var x=n();return _r(x)?x:x==null?[]:vr(x)}),c,d=!0;function m(){v.fallback=f,Yc(v,c,a,t,r),f!==null&&(c.length===0?(f.f&We)===0?Ls(f):(f.f^=We,Mn(f,null,a)):Tt(f,()=>{f=null}))}var _=Rr(()=>{c=p(h);for(var x=c.length,E=new Set,g=z,R=Ma(),b=0;b<x;b+=1){var A=c[b],F=r(A,b),P=d?null:o.get(F);P?(P.v&&Ct(P.v,A),P.i&&Ct(P.i,b),R&&g.skipped_effects.delete(P.e)):(P=Kc(o,d?a:Li??=lt(),A,F,b,s,t,n),d||(P.e.f|=We),o.set(F,P)),E.add(F)}if(x===0&&i&&!f&&(d?f=Ee(()=>i(a)):(f=Ee(()=>i(Li??=lt())),f.f|=We)),!d)if(R){for(const[y,T]of o)E.has(y)||g.skipped_effects.add(T.e);g.oncommit(m),g.ondiscard(()=>{})}else m();p(h)}),v={effect:_,items:o,outrogroups:null,fallback:f};d=!1}function Yc(e,t,n,r,s){var i=(r&Wu)!==0,a=t.length,o=e.items,l=e.effect.first,u,f=null,h,c=[],d=[],m,_,v,x;if(i)for(x=0;x<a;x+=1)m=t[x],_=s(m,x),v=o.get(_).e,(v.f&We)===0&&(v.nodes?.a?.measure(),(h??=new Set).add(v));for(x=0;x<a;x+=1){if(m=t[x],_=s(m,x),v=o.get(_).e,e.outrogroups!==null)for(const T of e.outrogroups)T.pending.delete(v),T.done.delete(v);if((v.f&We)!==0)if(v.f^=We,v===l)Mn(v,null,n);else{var E=f?f.next:l;v===e.effect.last&&(e.effect.last=v.prev),v.prev&&(v.prev.next=v.next),v.next&&(v.next.prev=v.prev),nt(e,f,v),nt(e,v,E),Mn(v,E,n),f=v,c=[],d=[],l=f.next;continue}if((v.f&ve)!==0&&(Ls(v),i&&(v.nodes?.a?.unfix(),(h??=new Set).delete(v))),v!==l){if(u!==void 0&&u.has(v)){if(c.length<d.length){var g=d[0],R;f=g.prev;var b=c[0],A=c[c.length-1];for(R=0;R<c.length;R+=1)Mn(c[R],g,n);for(R=0;R<d.length;R+=1)u.delete(d[R]);nt(e,b.prev,A.next),nt(e,f,b),nt(e,A,g),l=g,f=A,x-=1,c=[],d=[]}else u.delete(v),Mn(v,l,n),nt(e,v.prev,v.next),nt(e,v,f===null?e.effect.first:f.next),nt(e,f,v),f=v;continue}for(c=[],d=[];l!==null&&l!==v;)(u??=new Set).add(l),d.push(l),l=l.next;if(l===null)continue}(v.f&We)===0&&c.push(v),f=v,l=v.next}if(e.outrogroups!==null){for(const T of e.outrogroups)T.pending.size===0&&(gs(vr(T.done)),e.outrogroups?.delete(T));e.outrogroups.size===0&&(e.outrogroups=null)}if(l!==null||u!==void 0){var F=[];if(u!==void 0)for(v of u)(v.f&ve)===0&&F.push(v);for(;l!==null;)(l.f&ve)===0&&l!==e.fallback&&F.push(l),l=l.next;var P=F.length;if(P>0){var y=(r&Ea)!==0&&a===0?n:null;if(i){for(x=0;x<P;x+=1)F[x].nodes?.a?.measure();for(x=0;x<P;x+=1)F[x].nodes?.a?.fix()}qc(e,F,y)}}i&&Mt(()=>{if(h!==void 0)for(v of h)v.nodes?.a?.apply()})}function Kc(e,t,n,r,s,i,a,o){var l=(a&Yu)!==0?(a&ju)===0?N(n,!1,!1):Bt(n):null,u=(a&Ku)!==0?Bt(s):null;return{v:l,i:u,e:Ee(()=>(i(t,l??n,u??s,o),()=>{e.delete(r)}))}}function Mn(e,t,n){if(e.nodes)for(var r=e.nodes.start,s=e.nodes.end,i=t&&(t.f&We)===0?t.nodes.start:n;r!==null;){var a=zn(r);if(i.before(r),r===s)return;r=a}}function nt(e,t,n){t===null?e.effect.first=n:t.next=n,n===null?e.effect.last=t:n.prev=t}function gt(e,t,n){var r=new ja(e);Rr(()=>{var s=t()??null;r.ensure(s,s&&(i=>n(i,s)))},ft)}const Wc=()=>performance.now(),Ke={tick:e=>requestAnimationFrame(e),now:()=>Wc(),tasks:new Set};function Qa(){const e=Ke.now();Ke.tasks.forEach(t=>{t.c(e)||(Ke.tasks.delete(t),t.f())}),Ke.tasks.size!==0&&Ke.tick(Qa)}function jc(e){let t;return Ke.tasks.size===0&&Ke.tick(Qa),{promise:new Promise(n=>{Ke.tasks.add(t={c:e,f:n})}),abort(){Ke.tasks.delete(t)}}}function Kn(e,t){mn(()=>{e.dispatchEvent(new CustomEvent(t))})}function Qc(e){if(e==="float")return"cssFloat";if(e==="offset")return"cssOffset";if(e.startsWith("--"))return e;const t=e.split("-");return t.length===1?t[0]:t[0]+t.slice(1).map(n=>n[0].toUpperCase()+n.slice(1)).join("")}function Ui(e){const t={},n=e.split(";");for(const r of n){const[s,i]=r.split(":");if(!s||i===void 0)break;const a=Qc(s.trim());t[a]=i.trim()}return t}const Zc=e=>e;function Jc(e,t,n,r){var s=(e&nc)!==0,i="both",a,o=t.inert,l=t.style.overflow,u,f;function h(){return mn(()=>a??=n()(t,r?.()??{},{direction:i}))}var c={is_global:s,in(){t.inert=o,Kn(t,"introstart"),u=ys(t,h(),f,1,()=>{Kn(t,"introend"),u?.abort(),u=a=void 0,t.style.overflow=l})},out(v){t.inert=!0,Kn(t,"outrostart"),f=ys(t,h(),u,0,()=>{Kn(t,"outroend"),v?.()})},stop:()=>{u?.abort(),f?.abort()}},d=O;if((d.nodes.t??=[]).push(c),bs){var m=s;if(!m){for(var _=d.parent;_&&(_.f&ft)!==0;)for(;(_=_.parent)&&(_.f&Ue)===0;);m=!_||(_.f&br)!==0}m&&Gs(()=>{Fe(()=>c.in())})}}function ys(e,t,n,r,s){var i=r===1;if(Cu(t)){var a,o=!1;return Mt(()=>{if(!o){var v=t({direction:i?"in":"out"});a=ys(e,v,n,r,s)}}),{abort:()=>{o=!0,a?.abort()},deactivate:()=>a.deactivate(),reset:()=>a.reset(),t:()=>a.t()}}if(n?.deactivate(),!t?.duration)return s(),{abort:In,deactivate:In,reset:In,t:()=>r};const{delay:l=0,css:u,tick:f,easing:h=Zc}=t;var c=[];if(i&&n===void 0&&(f&&f(0,1),u)){var d=Ui(u(0,1));c.push(d,d)}var m=()=>1-r,_=e.animate(c,{duration:l,fill:"forwards"});return _.onfinish=()=>{_.cancel();var v=n?.t()??1-r;n?.abort();var x=r-v,E=t.duration*Math.abs(x),g=[];if(E>0){var R=!1;if(u)for(var b=Math.ceil(E/16.666666666666668),A=0;A<=b;A+=1){var F=v+x*h(A/b),P=Ui(u(F,1-F));g.push(P),R||=P.overflow==="hidden"}R&&(e.style.overflow="hidden"),m=()=>{var y=_.currentTime;return v+x*h(y/E)},f&&jc(()=>{if(_.playState!=="running")return!1;var y=m();return f(y,1-y),!0})}_=e.animate(g,{duration:E,fill:"forwards"}),_.onfinish=()=>{m=()=>r,f?.(r,1-r),s()}},{abort:()=>{_&&(_.cancel(),_.effect=null,_.onfinish=In)},deactivate:()=>{s=In},reset:()=>{r===0&&f?.(1,0)},t:()=>m()}}const Oi=[...` 	
\r\fÂ \v\uFEFF`];function ef(e,t,n){var r=e==null?"":""+e;if(n){for(var s in n)if(n[s])r=r?r+" "+s:s;else if(r.length)for(var i=s.length,a=0;(a=r.indexOf(s,a))>=0;){var o=a+i;(a===0||Oi.includes(r[a-1]))&&(o===r.length||Oi.includes(r[o]))?r=(a===0?"":r.substring(0,a))+r.substring(o+1):a=o}}return r===""?null:r}function Rs(e,t,n,r,s,i){var a=e.__className;if(a!==n||a===void 0){var o=ef(n,r,i);o==null?e.removeAttribute("class"):e.className=o,e.__className=n}else if(i&&s!==i)for(var l in i){var u=!!i[l];(s==null||u!==!!s[l])&&e.classList.toggle(l,u)}return i}function Za(e,t,n=!1){if(e.multiple){if(t==null)return;if(!_r(t))return ic();for(var r of e.options)r.selected=t.includes(kn(r));return}for(r of e.options){var s=kn(r);if(yc(s,t)){r.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function tf(e){var t=new MutationObserver(()=>{Za(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Er(()=>{t.disconnect()})}function Vi(e,t,n=t){var r=new WeakSet,s=!0;Tc(e,"change",i=>{var a=i?"[selected]":":checked",o;if(e.multiple)o=[].map.call(e.querySelectorAll(a),kn);else{var l=e.querySelector(a)??e.querySelector("option:not([disabled])");o=l&&kn(l)}n(o),z!==null&&r.add(z)}),Gs(()=>{var i=t();if(e===document.activeElement){var a=tr??z;if(r.has(a))return}if(Za(e,i,s),s&&i===void 0){var o=e.querySelector(":checked");o!==null&&(i=kn(o),n(i))}e.__value=i,s=!1}),tf(e)}function kn(e){return"__value"in e?e.__value:e.value}const nf=Symbol("is custom element"),rf=Symbol("is html");function sf(e,t){var n=Us(e);n.value===(n.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t??"")}function of(e,t){var n=Us(e);n.checked!==(n.checked=t??void 0)&&(e.checked=t)}function nr(e,t,n,r){var s=Us(e);s[t]!==(s[t]=n)&&(t==="loading"&&(e[ku]=n),n==null?e.removeAttribute(t):typeof n!="string"&&af(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function Us(e){return e.__attributes??={[nf]:e.nodeName.includes("-"),[rf]:e.namespaceURI===sc}}var Hi=new Map;function af(e){var t=e.getAttribute("is")||e.nodeName,n=Hi.get(t);if(n)return n;Hi.set(t,n=[]);for(var r,s=e,i=Element.prototype;i!==s;){r=pa(s);for(var a in r)r[a].set&&n.push(a);s=Ps(s)}return n}function lf(e,t,n){var r=At(e,t);r&&r.set&&(e[t]=n,Er(()=>{e[t]=null}))}function zi(e,t){return e===t||e?.[Qe]===t}function is(e={},t,n,r){return Gs(()=>{var s,i;return yr(()=>{s=i,i=[],Fe(()=>{e!==n(...i)&&(t(e,...i),s&&zi(n(...s),e)&&t(null,...s))})}),()=>{Mt(()=>{i&&zi(n(...i),e)&&t(null,...i)})}}),e}function Ve(e=!1){const t=$,n=t.l.u;if(!n)return;let r=()=>ke(t.s);if(e){let s=0,i={};const a=gr(()=>{let o=!1;const l=t.s;for(const u in l)l[u]!==i[u]&&(i[u]=l[u],o=!0);return o&&s++,s});r=()=>p(a)}n.b.length&&wc(()=>{Xi(t,r),hs(n.b)}),ps(()=>{const s=Fe(()=>n.m.map(Du));return()=>{for(const i of s)typeof i=="function"&&i()}}),n.a.length&&ps(()=>{Xi(t,r),hs(n.a)})}function Xi(e,t){if(e.l.s)for(const n of e.l.s)p(n);t()}let Wn=!1;function uf(e){var t=Wn;try{return Wn=!1,[e(),Wn]}finally{Wn=t}}function Y(e,t,n,r){var s=!hn||(n&Zu)!==0,i=(n&ec)!==0,a=(n&tc)!==0,o=r,l=!0,u=()=>(l&&(l=!1,o=a?Fe(r):r),o),f;if(i){var h=Qe in e||Nu in e;f=At(e,t)?.set??(h&&t in e?g=>e[t]=g:void 0)}var c,d=!1;i?[c,d]=uf(()=>e[t]):c=e[t],c===void 0&&r!==void 0&&(c=u(),f&&(s&&Hu(),f(c)));var m;if(s?m=()=>{var g=e[t];return g===void 0?u():(l=!0,g)}:m=()=>{var g=e[t];return g!==void 0&&(o=void 0),g===void 0?o:g},s&&(n&Ju)===0)return m;if(f){var _=e.$$legacy;return(function(g,R){return arguments.length>0?((!s||!R||_||d)&&f(R?m():g),g):m()})}var v=!1,x=((n&Qu)!==0?gr:st)(()=>(v=!1,m()));i&&p(x);var E=O;return(function(g,R){if(arguments.length>0){const b=R?p(x):s&&i?rn(g):g;return S(x,b),v=!0,o!==void 0&&(o=b),g}return Gt&&v||(E.f&je)!==0?x.v:p(x)})}function Ja(e){$===null&&Ds(),hn&&$.l!==null?df($).m.push(e):ps(()=>{const t=Fe(e);if(typeof t=="function")return t})}function cf(e){$===null&&Ds(),Ja(()=>()=>Fe(e))}function ff(e,t,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:r})}function Os(){const e=$;return e===null&&Ds(),(t,n,r)=>{const s=e.s.$$events?.[t];if(s){const i=_r(s)?s.slice():[s],a=ff(t,n,r);for(const o of i)o.call(e.x,a);return!a.defaultPrevented}return!0}}function df(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const hf="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(hf);uc();let Vs=Float32Array;function Hs(e,t,n){const r=new Vs(3);return e&&(r[0]=e),t&&(r[1]=t),n&&(r[2]=n),r}function mf(e,t,n){return n=n||new Vs(3),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function _f(e,t,n){return n=n||new Vs(3),n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n}let el=Float32Array;function vf(e){return e=e||new el(16),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function pf(e,t){t=t||new el(16);const n=e[0],r=e[1],s=e[2],i=e[3],a=e[4],o=e[5],l=e[6],u=e[7],f=e[8],h=e[9],c=e[10],d=e[11],m=e[12],_=e[13],v=e[14],x=e[15],E=c*x,g=v*d,R=l*x,b=v*u,A=l*d,F=c*u,P=s*x,y=v*i,T=s*d,C=c*i,K=s*u,Z=l*i,me=f*_,be=m*h,Ie=a*_,Xe=m*o,$e=a*h,qe=f*o,pt=n*_,Lt=m*r,Ut=n*h,Ot=f*r,xt=n*o,bt=a*r,gn=E*o+b*h+A*_-(g*o+R*h+F*_),En=g*r+P*h+C*_-(E*r+y*h+T*_),Vt=R*r+y*o+K*_-(b*r+P*o+Z*_),qn=F*r+T*o+Z*h-(A*r+C*o+K*h),Q=1/(n*gn+a*En+f*Vt+m*qn);return t[0]=Q*gn,t[1]=Q*En,t[2]=Q*Vt,t[3]=Q*qn,t[4]=Q*(g*a+R*f+F*m-(E*a+b*f+A*m)),t[5]=Q*(E*n+y*f+T*m-(g*n+P*f+C*m)),t[6]=Q*(b*n+P*a+Z*m-(R*n+y*a+K*m)),t[7]=Q*(A*n+C*a+K*f-(F*n+T*a+Z*f)),t[8]=Q*(me*u+Xe*d+$e*x-(be*u+Ie*d+qe*x)),t[9]=Q*(be*i+pt*d+Ot*x-(me*i+Lt*d+Ut*x)),t[10]=Q*(Ie*i+Lt*u+xt*x-(Xe*i+pt*u+bt*x)),t[11]=Q*(qe*i+Ut*u+bt*d-($e*i+Ot*u+xt*d)),t[12]=Q*(Ie*c+qe*v+be*l-($e*v+me*l+Xe*c)),t[13]=Q*(Ut*v+me*s+Lt*c-(pt*c+Ot*v+be*s)),t[14]=Q*(pt*l+bt*v+Xe*s-(xt*v+Ie*s+Lt*l)),t[15]=Q*(xt*c+$e*s+Ot*l-(Ut*l+bt*c+qe*s)),t}function xf(e,t,n){n=n||Hs();const r=t[0],s=t[1],i=t[2],a=r*e[3]+s*e[7]+i*e[11]+e[15];return n[0]=(r*e[0]+s*e[4]+i*e[8]+e[12])/a,n[1]=(r*e[1]+s*e[5]+i*e[9]+e[13])/a,n[2]=(r*e[2]+s*e[6]+i*e[10]+e[14])/a,n}function bf(e,t,n){n=n||Hs();const r=t[0],s=t[1],i=t[2];return n[0]=r*e[0]+s*e[4]+i*e[8],n[1]=r*e[1]+s*e[5]+i*e[9],n[2]=r*e[2]+s*e[6]+i*e[10],n}const zs=5120,Un=5121,Xs=5122,$s=5123,qs=5124,Ys=5125,Ks=5126,gf=32819,Ef=32820,yf=33635,Rf=5131,Sf=33640,Af=35899,Tf=35902,Ff=36269,wf=34042,tl={};{const e=tl;e[zs]=Int8Array,e[Un]=Uint8Array,e[Xs]=Int16Array,e[$s]=Uint16Array,e[qs]=Int32Array,e[Ys]=Uint32Array,e[Ks]=Float32Array,e[gf]=Uint16Array,e[Ef]=Uint16Array,e[yf]=Uint16Array,e[Rf]=Uint16Array,e[Sf]=Uint32Array,e[Af]=Uint32Array,e[Tf]=Uint32Array,e[Ff]=Uint32Array,e[wf]=Uint32Array}function Sr(e){if(e instanceof Int8Array)return zs;if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return Un;if(e instanceof Int16Array)return Xs;if(e instanceof Uint16Array)return $s;if(e instanceof Int32Array)return qs;if(e instanceof Uint32Array)return Ys;if(e instanceof Float32Array)return Ks;throw new Error("unsupported typed array type")}function nl(e){if(e===Int8Array)return zs;if(e===Uint8Array||e===Uint8ClampedArray)return Un;if(e===Int16Array)return Xs;if(e===Uint16Array)return $s;if(e===Int32Array)return qs;if(e===Uint32Array)return Ys;if(e===Float32Array)return Ks;throw new Error("unsupported typed array type")}function rl(e){const t=tl[e];if(!t)throw new Error("unknown gl type");return t}const On=typeof SharedArrayBuffer<"u"?function(t){return t&&t.buffer&&(t.buffer instanceof ArrayBuffer||t.buffer instanceof SharedArrayBuffer)}:function(t){return t&&t.buffer&&t.buffer instanceof ArrayBuffer};function If(e,t,n){e.forEach(function(r){const s=t[r];s!==void 0&&(n[r]=s)})}function sl(...e){console.error(...e)}const $i=new Map;function Ar(e,t){if(!e||typeof e!="object")return!1;let n=$i.get(t);n||(n=new WeakMap,$i.set(t,n));let r=n.get(e);if(r===void 0){const s=Object.prototype.toString.call(e);r=s.substring(8,s.length-1)===t,n.set(e,r)}return r}function Pf(e,t){return typeof WebGLBuffer<"u"&&Ar(t,"WebGLBuffer")}function il(e,t){return typeof WebGLRenderbuffer<"u"&&Ar(t,"WebGLRenderbuffer")}function Tr(e,t){return typeof WebGLTexture<"u"&&Ar(t,"WebGLTexture")}function Bf(e,t){return typeof WebGLSampler<"u"&&Ar(t,"WebGLSampler")}const ol=35044,ut=34962,al=34963,Cf=34660,Df=5120,Mf=5121,Nf=5122,kf=5123,Gf=5124,Lf=5125,ll=5126,ul={attribPrefix:""};function Uf(e,t,n,r,s){e.bindBuffer(t,n),e.bufferData(t,r,s||ol)}function Ws(e,t,n,r){if(Pf(e,t))return t;n=n||ut;const s=e.createBuffer();return Uf(e,n,s,t,r),s}function cl(e){return e==="indices"}function Of(e){return e===Int8Array||e===Uint8Array}function js(e){return e.length?e:e.data}const Vf=/coord|texture/i,Hf=/color|colour/i;function zf(e,t){let n;if(Vf.test(e)?n=2:Hf.test(e)?n=4:n=3,t%n>0)throw new Error(`Can not guess numComponents for attribute '${e}'. Tried ${n} but ${t} values is not evenly divisible by ${n}. You should specify it.`);return n}function Qs(e,t,n){return e.numComponents||e.size||zf(t,n||js(e).length)}function Fr(e,t){if(On(e))return e;if(On(e.data))return e.data;Array.isArray(e)&&(e={data:e});let n=e.type?Zs(e.type):void 0;return n||(cl(t)?n=Uint16Array:n=Float32Array),new n(e.data)}function Xf(e){return typeof e=="number"?e:e?nl(e):ll}function Zs(e){return typeof e=="number"?rl(e):e||Float32Array}function $f(e,t){return{buffer:t.buffer,numValues:24,type:Xf(t.type),arrayType:Zs(t.type)}}function qf(e,t){const n=t.data||t,r=Zs(t.type),s=n*r.BYTES_PER_ELEMENT,i=e.createBuffer();return e.bindBuffer(ut,i),e.bufferData(ut,s,t.drawType||ol),{buffer:i,numValues:n,type:nl(r),arrayType:r}}function Yf(e,t,n){const r=Fr(t,n);return{arrayType:r.constructor,buffer:Ws(e,r,void 0,t.drawType),type:Sr(r),numValues:0}}function Kf(e,t){const n={};return Object.keys(t).forEach(function(r){if(!cl(r)){const s=t[r],i=s.attrib||s.name||s.attribName||ul.attribPrefix+r;if(s.value){if(!Array.isArray(s.value)&&!On(s.value))throw new Error("array.value is not array or typedarray");n[i]={value:s.value}}else{let a;s.buffer&&s.buffer instanceof WebGLBuffer?a=$f:typeof s=="number"||typeof s.data=="number"?a=qf:a=Yf;const{buffer:o,type:l,numValues:u,arrayType:f}=a(e,s,r),h=s.normalize!==void 0?s.normalize:Of(f),c=Qs(s,r,u);n[i]={buffer:o,numComponents:c,type:l,normalize:h,stride:s.stride||0,offset:s.offset||0,divisor:s.divisor===void 0?void 0:s.divisor,drawType:s.drawType}}}}),e.bindBuffer(ut,null),n}function Wf(e,t){return t===Df||t===Mf?1:t===Nf||t===kf?2:t===Gf||t===Lf||t===ll?4:0}const on=["position","positions","a_position"];function jf(e){let t,n;for(n=0;n<on.length&&(t=on[n],!(t in e));++n);n===on.length&&(t=Object.keys(e)[0]);const r=e[t],s=js(r).length;if(s===void 0)return 1;const i=Qs(r,t),a=s/i;if(s%i>0)throw new Error(`numComponents ${i} not correct for length ${s}`);return a}function Qf(e,t){let n,r;for(r=0;r<on.length&&(n=on[r],!(n in t||(n=ul.attribPrefix+n,n in t)));++r);r===on.length&&(n=Object.keys(t)[0]);const s=t[n];if(!s.buffer)return 1;e.bindBuffer(ut,s.buffer);const i=e.getBufferParameter(ut,Cf);e.bindBuffer(ut,null);const a=Wf(e,s.type),o=i/a,l=s.numComponents||s.size,u=o/l;if(u%1!==0)throw new Error(`numComponents ${l} not correct for length ${length}`);return u}function Zf(e,t,n){const r=Kf(e,t),s=Object.assign({},n||{});s.attribs=Object.assign({},n?n.attribs:{},r);const i=t.indices;if(i){const a=Fr(i,"indices");s.indices=Ws(e,a,al),s.numElements=a.length,s.elementType=Sr(a)}else s.numElements||(s.numElements=Qf(e,s.attribs));return s}function Jf(e,t,n){const r=n==="indices"?al:ut,s=Fr(t,n);return Ws(e,s,r)}function ed(e,t){const n={};return Object.keys(t).forEach(function(r){n[r]=Jf(e,t[r],r)}),t.indices?(n.numElements=t.indices.length,n.elementType=Sr(Fr(t.indices))):n.numElements=jf(t),n}const Rt=js,td=Qs;function fl(e,t){let n=0;return e.push=function(){for(let r=0;r<arguments.length;++r){const s=arguments[r];if(s instanceof Array||On(s))for(let i=0;i<s.length;++i)e[n++]=s[i];else e[n++]=s}},e.reset=function(r){n=r||0},e.numComponents=t,Object.defineProperty(e,"numElements",{get:function(){return this.length/this.numComponents|0}}),e}function D(e,t,n){const r=n||Float32Array;return fl(new r(e*t),e)}function nd(e){return e!=="indices"}function rd(e){const t=e.indices,n={},r=t.length;function s(i){const a=e[i],o=a.numComponents,l=D(o,r,a.constructor);for(let u=0;u<r;++u){const h=t[u]*o;for(let c=0;c<o;++c)l.push(a[h+c])}n[i]=l}return Object.keys(e).filter(nd).forEach(s),n}function sd(e){if(e.indices)throw new Error("can not flatten normals of indexed vertices. deindex them first");const t=e.normal,n=t.length;for(let r=0;r<n;r+=9){const s=t[r+0],i=t[r+1],a=t[r+2],o=t[r+3],l=t[r+4],u=t[r+5],f=t[r+6],h=t[r+7],c=t[r+8];let d=s+o+f,m=i+l+h,_=a+u+c;const v=Math.sqrt(d*d+m*m+_*_);d/=v,m/=v,_/=v,t[r+0]=d,t[r+1]=m,t[r+2]=_,t[r+3]=d,t[r+4]=m,t[r+5]=_,t[r+6]=d,t[r+7]=m,t[r+8]=_}return e}function Js(e,t,n){const r=e.length,s=new Float32Array(3);for(let i=0;i<r;i+=3)n(t,[e[i],e[i+1],e[i+2]],s),e[i]=s[0],e[i+1]=s[1],e[i+2]=s[2]}function id(e,t,n){n=n||Hs();const r=t[0],s=t[1],i=t[2];return n[0]=r*e[0]+s*e[1]+i*e[2],n[1]=r*e[4]+s*e[5]+i*e[6],n[2]=r*e[8]+s*e[9]+i*e[10],n}function dl(e,t){return Js(e,t,bf),e}function hl(e,t){return Js(e,pf(t),id),e}function ml(e,t){return Js(e,t,xf),e}function _l(e,t){return Object.keys(e).forEach(function(n){const r=e[n];n.indexOf("pos")>=0?ml(r,t):n.indexOf("tan")>=0||n.indexOf("binorm")>=0?dl(r,t):n.indexOf("norm")>=0&&hl(r,t)}),e}function ei(e,t,n){return e=e||2,t=t||0,n=n||0,e*=.5,{position:{numComponents:2,data:[t+-1*e,n+-1*e,t+1*e,n+-1*e,t+-1*e,n+1*e,t+1*e,n+1*e]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function ti(e,t,n,r,s){e=e||1,t=t||1,n=n||1,r=r||1,s=s||vf();const i=(n+1)*(r+1),a=D(3,i),o=D(3,i),l=D(2,i);for(let c=0;c<=r;c++)for(let d=0;d<=n;d++){const m=d/n,_=c/r;a.push(e*m-e*.5,0,t*_-t*.5),o.push(0,1,0),l.push(m,_)}const u=n+1,f=D(3,n*r*2,Uint16Array);for(let c=0;c<r;c++)for(let d=0;d<n;d++)f.push((c+0)*u+d,(c+1)*u+d,(c+0)*u+d+1),f.push((c+1)*u+d,(c+1)*u+d+1,(c+0)*u+d+1);return _l({position:a,normal:o,texcoord:l,indices:f},s)}function ni(e,t,n,r,s,i,a){if(t<=0||n<=0)throw new Error("subdivisionAxis and subdivisionHeight must be > 0");r=r||0,s=s||Math.PI,i=i||0,a=a||Math.PI*2;const o=s-r,l=a-i,u=(t+1)*(n+1),f=D(3,u),h=D(3,u),c=D(2,u);for(let _=0;_<=n;_++)for(let v=0;v<=t;v++){const x=v/t,E=_/n,g=l*x+i,R=o*E+r,b=Math.sin(g),A=Math.cos(g),F=Math.sin(R),P=Math.cos(R),y=A*F,T=P,C=b*F;f.push(e*y,e*T,e*C),h.push(y,T,C),c.push(1-x,E)}const d=t+1,m=D(3,t*n*2,Uint16Array);for(let _=0;_<t;_++)for(let v=0;v<n;v++)m.push((v+0)*d+_,(v+0)*d+_+1,(v+1)*d+_),m.push((v+1)*d+_,(v+0)*d+_+1,(v+1)*d+_+1);return{position:f,normal:h,texcoord:c,indices:m}}const od=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function ri(e){e=e||1;const t=e/2,n=[[-t,-t,-t],[+t,-t,-t],[-t,+t,-t],[+t,+t,-t],[-t,-t,+t],[+t,-t,+t],[-t,+t,+t],[+t,+t,+t]],r=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],s=[[1,0],[0,0],[0,1],[1,1]],i=24,a=D(3,i),o=D(3,i),l=D(2,i),u=D(3,12,Uint16Array);for(let f=0;f<6;++f){const h=od[f];for(let d=0;d<4;++d){const m=n[h[d]],_=r[f],v=s[d];a.push(m),o.push(_),l.push(v)}const c=4*f;u.push(c+0,c+1,c+2),u.push(c+0,c+2,c+3)}return{position:a,normal:o,texcoord:l,indices:u}}function wr(e,t,n,r,s,i,a){if(r<3)throw new Error("radialSubdivisions must be 3 or greater");if(s<1)throw new Error("verticalSubdivisions must be 1 or greater");const o=i===void 0?!0:i,l=a===void 0?!0:a,u=(o?2:0)+(l?2:0),f=(r+1)*(s+1+u),h=D(3,f),c=D(3,f),d=D(2,f),m=D(3,r*(s+u/2)*2,Uint16Array),_=r+1,v=Math.atan2(e-t,n),x=Math.cos(v),E=Math.sin(v),g=o?-2:0,R=s+(l?2:0);for(let b=g;b<=R;++b){let A=b/s,F=n*A,P;b<0?(F=0,A=1,P=e):b>s?(F=n,A=1,P=t):P=e+(t-e)*(b/s),(b===-2||b===s+2)&&(P=0,A=0),F-=n/2;for(let y=0;y<_;++y){const T=Math.sin(y*Math.PI*2/r),C=Math.cos(y*Math.PI*2/r);h.push(T*P,F,C*P),b<0?c.push(0,-1,0):b>s?c.push(0,1,0):P===0?c.push(0,0,0):c.push(T*x,E,C*x),d.push(y/r,1-A)}}for(let b=0;b<s+u;++b)if(!(b===1&&o||b===s+u-2&&l))for(let A=0;A<r;++A)m.push(_*(b+0)+0+A,_*(b+0)+1+A,_*(b+1)+1+A),m.push(_*(b+0)+0+A,_*(b+1)+1+A,_*(b+1)+0+A);return{position:h,normal:c,texcoord:d,indices:m}}function qi(e,t){t=t||[];const n=[];for(let r=0;r<e.length;r+=4){const s=e[r],i=e.slice(r+1,r+4);i.push.apply(i,t);for(let a=0;a<s;++a)n.push.apply(n,i)}return n}function si(){const e=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],t=[.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0],n=qi([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),r=qi([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),s=e.length/3,i={position:D(3,s),texcoord:D(2,s),normal:D(3,s),color:D(4,s,Uint8Array),indices:D(3,s/3,Uint16Array)};i.position.push(e),i.texcoord.push(t),i.normal.push(n),i.color.push(r);for(let a=0;a<s;++a)i.indices.push(a);return i}function Ir(e,t,n,r,s,i,a){if(s<=0)throw new Error("subdivisionDown must be > 0");i=i||0,a=a||1;const o=2,l=a-i,u=(s+1)*2*(2+o),f=D(3,u),h=D(3,u),c=D(2,u);function d(E,g,R){return E+(g-E)*R}function m(E,g,R,b,A,F){for(let P=0;P<=s;P++){const y=g/(o-1),T=P/s,C=(y-.5)*2,K=(i+T*l)*Math.PI,Z=Math.sin(K),me=Math.cos(K),be=d(e,E,Z),Ie=C*r,Xe=me*e,$e=Z*be;f.push(Ie,Xe,$e);const qe=mf(_f([0,Z,me],R),b);h.push(qe),c.push(y*A+F,T)}}for(let E=0;E<o;E++){const g=(E/(o-1)-.5)*2;m(t,E,[1,1,1],[0,0,0],1,0),m(t,E,[0,0,0],[g,0,0],0,0),m(n,E,[1,1,1],[0,0,0],1,0),m(n,E,[0,0,0],[g,0,0],0,1)}const _=D(3,s*2*(2+o),Uint16Array);function v(E,g){for(let R=0;R<s;++R)_.push(E+R+0,E+R+1,g+R+0),_.push(E+R+1,g+R+1,g+R+0)}const x=s+1;return v(x*0,x*4),v(x*5,x*7),v(x*6,x*2),v(x*3,x*1),{position:f,normal:h,texcoord:c,indices:_}}function ii(e,t,n,r,s,i){return wr(e,e,t,n,r,s,i)}function oi(e,t,n,r,s,i){if(n<3)throw new Error("radialSubdivisions must be 3 or greater");if(r<3)throw new Error("verticalSubdivisions must be 3 or greater");s=s||0,i=i||Math.PI*2;const a=i-s,o=n+1,l=r+1,u=o*l,f=D(3,u),h=D(3,u),c=D(2,u),d=D(3,n*r*2,Uint16Array);for(let m=0;m<l;++m){const _=m/r,v=_*Math.PI*2,x=Math.sin(v),E=e+x*t,g=Math.cos(v),R=g*t;for(let b=0;b<o;++b){const A=b/n,F=s+A*a,P=Math.sin(F),y=Math.cos(F),T=P*E,C=y*E,K=P*x,Z=y*x;f.push(T,R,C),h.push(K,g,Z),c.push(A,1-_)}}for(let m=0;m<r;++m)for(let _=0;_<n;++_){const v=1+_,x=1+m;d.push(o*m+_,o*x+_,o*m+v),d.push(o*x+_,o*x+v,o*m+v)}return{position:f,normal:h,texcoord:c,indices:d}}function ai(e,t,n,r,s){if(t<3)throw new Error("divisions must be at least 3");n=n||1,s=s||1,r=r||0;const i=(t+1)*(n+1),a=D(3,i),o=D(3,i),l=D(2,i),u=D(3,n*t*2,Uint16Array);let f=0;const h=e-r,c=t+1;for(let d=0;d<=n;++d){const m=r+h*Math.pow(d/n,s);for(let _=0;_<=t;++_){const v=2*Math.PI*_/t,x=m*Math.cos(v),E=m*Math.sin(v);if(a.push(x,0,E),o.push(0,1,0),l.push(1-_/t,d/n),d>0&&_!==t){const g=f+(_+1),R=f+_,b=f+_-c,A=f+(_+1)-c;u.push(g,R,b),u.push(g,b,A)}}f+=t+1}return{position:a,normal:o,texcoord:l,indices:u}}function ad(e){return Math.random()*e|0}function ld(e,t){t=t||{};const n=e.position.numElements,r=D(4,n,Uint8Array),s=t.rand||function(i,a){return a<3?ad(256):255};if(e.color=r,e.indices)for(let i=0;i<n;++i)r.push(s(i,0),s(i,1),s(i,2),s(i,3));else{const i=t.vertsPerColor||3,a=n/i;for(let o=0;o<a;++o){const l=[s(o,0),s(o,1),s(o,2),s(o,3)];for(let u=0;u<i;++u)r.push(l)}}return e}function He(e){return function(t){const n=e.apply(this,Array.prototype.slice.call(arguments,1));return ed(t,n)}}function ze(e){return function(t){const n=e.apply(null,Array.prototype.slice.call(arguments,1));return Zf(t,n)}}const ud=["numComponents","size","type","normalize","stride","offset","attrib","name","attribName"];function Ss(e,t,n,r){r=r||0;const s=e.length;for(let i=0;i<s;++i)t[n+i]=e[i]+r}function vl(e,t){const n=Rt(e),r=new n.constructor(t);let s=r;return n.numComponents&&n.numElements&&fl(r,n.numComponents),e.data&&(s={data:r},If(ud,e,s)),s}function cd(e){const t={};let n;for(let o=0;o<e.length;++o){const l=e[o];Object.keys(l).forEach(function(u){t[u]||(t[u]=[]),!n&&u!=="indices"&&(n=u);const f=l[u],h=td(f,u),d=Rt(f).length/h;t[u].push(d)})}function r(o){let l=0,u;for(let f=0;f<e.length;++f){const c=e[f][o],d=Rt(c);l+=d.length,(!u||c.data)&&(u=c)}return{length:l,spec:u}}function s(o,l,u){let f=0,h=0;for(let c=0;c<e.length;++c){const m=e[c][o],_=Rt(m);o==="indices"?(Ss(_,u,h,f),f+=l[c]):Ss(_,u,h),h+=_.length}}const i=t[n],a={};return Object.keys(t).forEach(function(o){const l=r(o),u=vl(l.spec,l.length);s(o,i,Rt(u)),a[o]=u}),a}function fd(e){const t={};return Object.keys(e).forEach(function(n){const r=e[n],s=Rt(r),i=vl(r,s.length);Ss(s,Rt(i),0),t[n]=i}),t}const dd=ze(si),hd=He(si),md=ze(ri),_d=He(ri),vd=ze(ti),pd=He(ti),xd=ze(ni),bd=He(ni),gd=ze(wr),Ed=He(wr),yd=ze(ei),Rd=He(ei),pl=ze(Ir),xl=He(Ir),Sd=ze(ii),Ad=He(ii),Td=ze(oi),Fd=He(oi),wd=ze(ai),Id=He(ai),Pd=pl,Bd=xl,Cd=Ir;var bl=Object.freeze({__proto__:null,create3DFBufferInfo:dd,create3DFBuffers:hd,create3DFVertices:si,createAugmentedTypedArray:D,createCubeBufferInfo:md,createCubeBuffers:_d,createCubeVertices:ri,createPlaneBufferInfo:vd,createPlaneBuffers:pd,createPlaneVertices:ti,createSphereBufferInfo:xd,createSphereBuffers:bd,createSphereVertices:ni,createTruncatedConeBufferInfo:gd,createTruncatedConeBuffers:Ed,createTruncatedConeVertices:wr,createXYQuadBufferInfo:yd,createXYQuadBuffers:Rd,createXYQuadVertices:ei,createCresentBufferInfo:Pd,createCresentBuffers:Bd,createCresentVertices:Cd,createCrescentBufferInfo:pl,createCrescentBuffers:xl,createCrescentVertices:Ir,createCylinderBufferInfo:Sd,createCylinderBuffers:Ad,createCylinderVertices:ii,createTorusBufferInfo:Td,createTorusBuffers:Fd,createTorusVertices:oi,createDiscBufferInfo:wd,createDiscBuffers:Id,createDiscVertices:ai,deindexVertices:rd,flattenNormals:sd,makeRandomVertexColors:ld,reorientDirections:dl,reorientNormals:hl,reorientPositions:ml,reorientVertices:_l,concatVertices:cd,duplicateVertices:fd});function Xn(e){return!!e.texStorage2D}const gl=(function(){const e={},t={};function n(r){const s=r.constructor.name;if(!e[s]){for(const i in r)if(typeof r[i]=="number"){const a=t[r[i]];t[r[i]]=a?`${a} | ${i}`:i}e[s]=!0}}return function(s,i){return n(s),t[i]||(typeof i=="number"?`0x${i.toString(16)}`:i)}})(),Pn=void 0,ht={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},fn=On,El=(function(){let e;return function(){return e=e||(typeof document<"u"&&document.createElement?document.createElement("canvas").getContext("2d"):null),e}})(),Yi=6406,Pe=6407,q=6408,Ki=6409,Wi=6410,Bn=6402,ji=34041,ur=33071,os=9728,as=9729,Dd=9986,Ge=3553,Le=34067,mt=32879,dt=35866,Pr=34069,Md=34070,Nd=34071,kd=34072,Gd=34073,Ld=34074,cr=10241,fr=10240,dr=10242,hr=10243,Qi=32882,Ud=33082,Od=33083,Vd=33084,Hd=33085,zd=34892,Xd=34893,li=3317,yl=3314,Rl=32878,Sl=3316,Al=3315,Tl=32877,rr=37443,sr=37441,ir=37440,$d=33321,qd=36756,Yd=33325,Kd=33326,Wd=33330,jd=33329,Qd=33338,Zd=33337,Jd=33340,e0=33339,t0=33323,n0=36757,r0=33327,s0=33328,i0=33336,o0=33335,a0=33332,l0=33331,u0=33334,c0=33333,f0=32849,d0=35905,h0=36194,m0=36758,_0=35898,v0=35901,p0=34843,x0=34837,b0=36221,g0=36239,E0=36215,y0=36233,R0=36209,S0=36227,A0=32856,T0=35907,F0=36759,w0=32855,I0=32854,P0=32857,B0=34842,C0=34836,D0=36220,M0=36238,N0=36975,k0=36214,G0=36232,L0=36226,U0=36208,O0=33189,V0=33190,H0=36012,z0=36013,X0=35056,rt=5120,X=5121,jn=5122,jt=5123,Qn=5124,Et=5125,re=5126,Zi=32819,Ji=32820,eo=33635,Re=5131,Cn=36193,ls=33640,$0=35899,q0=35902,Y0=36269,K0=34042,Zn=33319,Qt=33320,Jn=6403,Zt=36244,Jt=36248,yt=36249,to=33776,no=33777,ro=33778,so=33779,io=35916,oo=35917,ao=35918,lo=35919,uo=36196,co=37488,fo=37489,ho=37490,mo=37491,_o=37492,vo=37493,po=37494,xo=37495,bo=37496,go=37497,Eo=35840,yo=35841,Ro=35842,So=35843,Ao=37808,To=37809,Fo=37810,wo=37811,Io=37812,Po=37813,Bo=37814,Co=37815,Do=37816,Mo=37817,No=37818,ko=37819,Go=37820,Lo=37821,Uo=37840,Oo=37841,Vo=37842,Ho=37843,zo=37844,Xo=37845,$o=37846,qo=37847,Yo=37848,Ko=37849,Wo=37850,jo=37851,Qo=37852,Zo=37853,Jo=36492,ea=36493,ta=36494,na=36495,ra=36283,sa=36284,ia=36285,oa=36286;let us;function vn(e){if(!us){const n={};n[Yi]={textureFormat:Yi,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[X,Re,Cn,re]},n[Ki]={textureFormat:Ki,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[X,Re,Cn,re]},n[Wi]={textureFormat:Wi,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[X,Re,Cn,re]},n[Pe]={textureFormat:Pe,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[X,Re,Cn,re,eo]},n[q]={textureFormat:q,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[X,Re,Cn,re,Zi,Ji]},n[Bn]={textureFormat:Bn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[Et,jt]},n[$d]={textureFormat:Jn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[X]},n[qd]={textureFormat:Jn,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[rt]},n[Yd]={textureFormat:Jn,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[re,Re]},n[Kd]={textureFormat:Jn,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[re]},n[Wd]={textureFormat:Zt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[X]},n[jd]={textureFormat:Zt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[rt]},n[a0]={textureFormat:Zt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[jt]},n[l0]={textureFormat:Zt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[jn]},n[u0]={textureFormat:Zt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Et]},n[c0]={textureFormat:Zt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Qn]},n[t0]={textureFormat:Zn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[X]},n[n0]={textureFormat:Zn,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[rt]},n[r0]={textureFormat:Zn,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[re,Re]},n[s0]={textureFormat:Zn,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[re]},n[i0]={textureFormat:Qt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[X]},n[o0]={textureFormat:Qt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[rt]},n[Qd]={textureFormat:Qt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[jt]},n[Zd]={textureFormat:Qt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[jn]},n[Jd]={textureFormat:Qt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Et]},n[e0]={textureFormat:Qt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Qn]},n[f0]={textureFormat:Pe,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[X]},n[d0]={textureFormat:Pe,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[X]},n[h0]={textureFormat:Pe,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[X,eo]},n[m0]={textureFormat:Pe,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[rt]},n[_0]={textureFormat:Pe,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[re,Re,$0]},n[v0]={textureFormat:Pe,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[re,Re,q0]},n[p0]={textureFormat:Pe,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[re,Re]},n[x0]={textureFormat:Pe,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[re]},n[b0]={textureFormat:Jt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[X]},n[g0]={textureFormat:Jt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[rt]},n[E0]={textureFormat:Jt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[jt]},n[y0]={textureFormat:Jt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[jn]},n[R0]={textureFormat:Jt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[Et]},n[S0]={textureFormat:Jt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[Qn]},n[A0]={textureFormat:q,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[X]},n[T0]={textureFormat:q,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[X]},n[F0]={textureFormat:q,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[rt]},n[w0]={textureFormat:q,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[X,Ji,ls]},n[I0]={textureFormat:q,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[X,Zi]},n[P0]={textureFormat:q,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[ls]},n[B0]={textureFormat:q,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[re,Re]},n[C0]={textureFormat:q,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[re]},n[D0]={textureFormat:yt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[X]},n[M0]={textureFormat:yt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[rt]},n[N0]={textureFormat:yt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ls]},n[k0]={textureFormat:yt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[jt]},n[G0]={textureFormat:yt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[jn]},n[L0]={textureFormat:yt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[Qn]},n[U0]={textureFormat:yt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[Et]},n[O0]={textureFormat:Bn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[jt,Et]},n[V0]={textureFormat:Bn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Et]},n[H0]={textureFormat:Bn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[re]},n[X0]={textureFormat:ji,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[K0]},n[z0]={textureFormat:ji,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Y0]},Object.keys(n).forEach(function(i){const a=n[i];a.bytesPerElementMap={},a.bytesPerElement.forEach(function(o,l){const u=a.type[l];a.bytesPerElementMap[u]=o})});const r={bytes:8,width:4,height:4},s={bytes:16,width:4,height:4};n[to]={textureFormat:to,colorRenderable:!1,textureFilterable:!0,block:r},n[no]={textureFormat:no,colorRenderable:!1,textureFilterable:!0,block:r},n[ro]={textureFormat:ro,colorRenderable:!1,textureFilterable:!0,block:s},n[so]={textureFormat:so,colorRenderable:!1,textureFilterable:!0,block:s},n[io]={textureFormat:io,colorRenderable:!1,textureFilterable:!0,block:r},n[oo]={textureFormat:oo,colorRenderable:!1,textureFilterable:!0,block:r},n[ao]={textureFormat:ao,colorRenderable:!1,textureFilterable:!0,block:s},n[lo]={textureFormat:lo,colorRenderable:!1,textureFilterable:!0,block:s},n[uo]={textureFormat:uo,colorRenderable:!1,textureFilterable:!0,block:r},n[co]={textureFormat:co,colorRenderable:!1,textureFilterable:!0,block:r},n[fo]={textureFormat:fo,colorRenderable:!1,textureFilterable:!0,block:r},n[ho]={textureFormat:ho,colorRenderable:!1,textureFilterable:!0,block:s},n[mo]={textureFormat:mo,colorRenderable:!1,textureFilterable:!0,block:s},n[_o]={textureFormat:_o,colorRenderable:!1,textureFilterable:!0,block:r},n[vo]={textureFormat:vo,colorRenderable:!1,textureFilterable:!0,block:r},n[po]={textureFormat:po,colorRenderable:!1,textureFilterable:!0,block:r},n[xo]={textureFormat:xo,colorRenderable:!1,textureFilterable:!0,block:r},n[bo]={textureFormat:bo,colorRenderable:!1,textureFilterable:!0,block:s},n[go]={textureFormat:go,colorRenderable:!1,textureFilterable:!0,block:s},n[Eo]={textureFormat:Eo,colorRenderable:!1,textureFilterable:!0,block:{bytes:32,width:8,height:8}},n[yo]={textureFormat:yo,colorRenderable:!1,textureFilterable:!0,block:{bytes:32,width:16,height:8}},n[Ro]={textureFormat:Ro,colorRenderable:!1,textureFilterable:!0,block:{bytes:32,width:8,height:8}},n[So]={textureFormat:So,colorRenderable:!1,textureFilterable:!0,block:{bytes:32,width:16,height:8}},n[Ao]={textureFormat:Ao,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:4,height:4}},n[To]={textureFormat:To,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:5,height:4}},n[Fo]={textureFormat:Fo,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:5,height:5}},n[wo]={textureFormat:wo,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:6,height:5}},n[Io]={textureFormat:Io,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:6,height:6}},n[Po]={textureFormat:Po,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:8,height:5}},n[Bo]={textureFormat:Bo,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:8,height:6}},n[Co]={textureFormat:Co,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:8,height:8}},n[Do]={textureFormat:Do,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:10,height:5}},n[Mo]={textureFormat:Mo,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:10,height:6}},n[No]={textureFormat:No,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:10,height:8}},n[ko]={textureFormat:ko,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:10,height:10}},n[Go]={textureFormat:Go,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:12,height:10}},n[Lo]={textureFormat:Lo,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:12,height:12}},n[Uo]={textureFormat:Uo,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:4,height:4}},n[Oo]={textureFormat:Oo,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:5,height:4}},n[Vo]={textureFormat:Vo,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:5,height:5}},n[Ho]={textureFormat:Ho,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:6,height:5}},n[zo]={textureFormat:zo,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:6,height:6}},n[Xo]={textureFormat:Xo,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:8,height:5}},n[$o]={textureFormat:$o,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:8,height:6}},n[qo]={textureFormat:qo,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:8,height:8}},n[Yo]={textureFormat:Yo,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:10,height:5}},n[Ko]={textureFormat:Ko,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:10,height:6}},n[Wo]={textureFormat:Wo,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:10,height:8}},n[jo]={textureFormat:jo,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:10,height:10}},n[Qo]={textureFormat:Qo,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:12,height:10}},n[Zo]={textureFormat:Zo,colorRenderable:!1,textureFilterable:!0,block:{bytes:16,width:12,height:12}},n[Jo]={textureFormat:Jo,colorRenderable:!1,textureFilterable:!0,block:s},n[ea]={textureFormat:ea,colorRenderable:!1,textureFilterable:!0,block:s},n[ta]={textureFormat:ta,colorRenderable:!1,textureFilterable:!0,block:s},n[na]={textureFormat:na,colorRenderable:!1,textureFilterable:!0,block:s},n[ra]={textureFormat:ra,colorRenderable:!1,textureFilterable:!0,block:r},n[sa]={textureFormat:sa,colorRenderable:!1,textureFilterable:!0,block:r},n[ia]={textureFormat:ia,colorRenderable:!1,textureFilterable:!0,block:r},n[oa]={textureFormat:oa,colorRenderable:!1,textureFilterable:!0,block:r},us=n}const t=us[e];if(!t)throw new Error("unknown internal format");return t}function Fl(e,t){const r=vn(e).bytesPerElementMap[t];if(r===void 0)throw new Error("type not supported for internal format");return r}function pn(e){const t=vn(e);if(!t)throw new Error("unknown internal format");return{format:t.textureFormat,type:t.type?.[0]??X}}function wl(e){return!!vn(e).block}function W0(e,t){const n=vn(e);return n.block?{blockWidth:n.block.width,blockHeight:n.block.height,bytesPerBlock:n.block.bytes}:{blockWidth:1,blockHeight:1,bytesPerBlock:Fl(e,t)}}function aa(e){return(e&e-1)===0}function j0(e,t,n,r){if(!Xn(e))return aa(t)&&aa(n);const s=vn(r);return s.colorRenderable&&s.textureFilterable}function cs(e){return vn(e).textureFilterable}function Il(e,t,n){return fn(t)?Sr(t):n||X}function er(e,t,n,r,s){if(s%1!==0)throw new Error("can't guess dimensions");if(!n&&!r){const i=Math.sqrt(s/(t===Le?6:1));i%1===0?(n=i,r=i):(n=s,r=1)}else if(r){if(!n&&(n=s/r,n%1))throw new Error("can't guess dimensions")}else if(r=s/n,r%1)throw new Error("can't guess dimensions");return{width:n,height:r}}function it(e,t,n){let r,s,i;t.colorspaceConversion!==void 0&&(r=e.getParameter(rr),e.pixelStorei(rr,t.colorspaceConversion)),t.premultiplyAlpha!==void 0&&(s=e.getParameter(sr),e.pixelStorei(sr,t.premultiplyAlpha)),t.flipY!==void 0&&(i=e.getParameter(ir),e.pixelStorei(ir,t.flipY)),n(),r!==void 0&&e.pixelStorei(rr,r),s!==void 0&&e.pixelStorei(sr,s),i!==void 0&&e.pixelStorei(ir,i)}function fs(e,t,n,r){const s=t[n];return{[n]:s===void 0?e.getParameter(r):s}}function ui(e,t){return{...t,...fs(e,t,"flipY",ir),...fs(e,t,"premultiplyAlpha",sr),...fs(e,t,"colorspaceConversion",rr)}}function Pl(e){e.pixelStorei(li,4),Xn(e)&&(e.pixelStorei(yl,0),e.pixelStorei(Rl,0),e.pixelStorei(Sl,0),e.pixelStorei(Al,0),e.pixelStorei(Tl,0))}function Q0(e,t,n,r){r.minMag&&(n.call(e,t,cr,r.minMag),n.call(e,t,fr,r.minMag)),r.min&&n.call(e,t,cr,r.min),r.mag&&n.call(e,t,fr,r.mag),r.wrap&&(n.call(e,t,dr,r.wrap),n.call(e,t,hr,r.wrap),(t===mt||Bf(e,t))&&n.call(e,t,Qi,r.wrap)),r.wrapR&&n.call(e,t,Qi,r.wrapR),r.wrapS&&n.call(e,t,dr,r.wrapS),r.wrapT&&n.call(e,t,hr,r.wrapT),r.minLod!==void 0&&n.call(e,t,Ud,r.minLod),r.maxLod!==void 0&&n.call(e,t,Od,r.maxLod),r.baseLevel!==void 0&&n.call(e,t,Vd,r.baseLevel),r.maxLevel!==void 0&&n.call(e,t,Hd,r.maxLevel),r.compareFunc!==void 0&&n.call(e,t,Xd,r.compareFunc),r.compareMode!==void 0&&n.call(e,t,zd,r.compareMode)}function Bl(e,t,n){const r=n.target||Ge;e.bindTexture(r,t),Q0(e,r,e.texParameteri,n)}function Z0(e){return e=e||ht.textureColor,fn(e)?e:new Uint8Array([e[0]*255,e[1]*255,e[2]*255,e[3]*255])}function Cl(e,t,{options:n,width:r,height:s,internalFormat:i,lastMipLevelUploaded:a}){n=n||ht.textureOptions,i=i||q;const o=n.target||Ge;if(r=r||n.width,s=s||n.height,e.bindTexture(o,t),a>1){const l=Math.max(1,r>>a),u=Math.max(1,s>>a),f=l===1&&u===1,h=cs(i)?as:os,c=cs(i)?f?Dd:as:os;e.texParameteri(o,fr,h),e.texParameteri(o,cr,c)}else if(j0(e,r,s,i))e.generateMipmap(o);else{const l=cs(i)?as:os;e.texParameteri(o,cr,l),e.texParameteri(o,fr,l),e.texParameteri(o,dr,ur),e.texParameteri(o,hr,ur)}}function la(e,t,n,r,s,i){Cl(e,t,{options:n,width:r,height:s,internalFormat:i})}function Vn(e){return e.auto===!0||e.auto===void 0&&e.level===void 0}function As(e,t){return t=t||{},t.cubeFaceOrder||[Pr,Md,Nd,kd,Gd,Ld]}function Ts(e,t){const r=As(e,t).map(function(s,i){return{face:s,ndx:i}});return r.sort(function(s,i){return s.face-i.face}),r}function Dl(e,t,n,r){r=r||ht.textureOptions;const s=r.target||Ge,i=r.level||0;let a=n.width,o=n.height;const l=r.internalFormat||r.format||q,u=pn(l),f=r.format||u.format,h=r.type||u.type;if(e.bindTexture(s,t),s===Le){const c=n.width,d=n.height;let m,_;if(c/6===d)m=d,_=[0,0,1,0,2,0,3,0,4,0,5,0];else if(d/6===c)m=c,_=[0,0,0,1,0,2,0,3,0,4,0,5];else if(c/3===d/2)m=c/3,_=[0,0,1,0,2,0,0,1,1,1,2,1];else if(c/2===d/3)m=c/2,_=[0,0,1,0,0,1,1,1,0,2,1,2];else throw new Error(`can't figure out cube map from element: ${n.src?n.src:n.nodeName}`);const v=El();v?(v.canvas.width=m,v.canvas.height=m,a=m,o=m,it(e,r,()=>{Ts(e,r).forEach(function(x){const E=_[x.ndx*2+0]*m,g=_[x.ndx*2+1]*m;v.drawImage(n,E,g,m,m,0,0,m,m),e.texImage2D(x.face,i,l,f,h,v.canvas)}),v.canvas.width=1,v.canvas.height=1})):typeof createImageBitmap<"u"&&(a=m,o=m,Ts(e,r).forEach(function(x){const E=_[x.ndx*2+0]*m,g=_[x.ndx*2+1]*m;e.texImage2D(x.face,i,l,m,m,0,f,h,null),createImageBitmap(n,E,g,m,m,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(function(R){it(e,r,()=>{e.bindTexture(s,t),e.texImage2D(x.face,i,l,f,h,R),Vn(r)&&la(e,t,r,a,o,l)})})}))}else s===mt||s===dt?it(e,r,()=>{const c=Math.min(n.width,n.height),d=Math.max(n.width,n.height),m=d/c;if(m%1!==0)throw new Error("can not compute 3D dimensions of element");const _=n.width===d?1:0,v=n.height===d?1:0;e.pixelStorei(li,1),e.pixelStorei(yl,n.width),e.pixelStorei(Rl,0),e.pixelStorei(Tl,0),e.texImage3D(s,i,l,c,c,c,0,f,h,null);for(let x=0;x<m;++x){const E=x*c*_,g=x*c*v;e.pixelStorei(Sl,E),e.pixelStorei(Al,g),e.texSubImage3D(s,i,0,0,x,c,c,1,f,h,n)}Pl(e)}):it(e,r,()=>{e.texImage2D(s,i,l,f,h,n)});Vn(r)&&la(e,t,r,a,o,l),Bl(e,t,r)}function $n(){}function J0(e){if(typeof document<"u"){const t=document.createElement("a");return t.href=e,t.hostname===location.hostname&&t.port===location.port&&t.protocol===location.protocol}else{const t=new URL(location.href).origin;return new URL(e,location.href).origin===t}}function eh(e,t){return t===void 0&&!J0(e)?"anonymous":t}function th(e,t,n){n=n||$n;let r;if(t=t!==void 0?t:ht.crossOrigin,t=eh(e,t),typeof Image<"u"){r=new Image,t!==void 0&&(r.crossOrigin=t);const s=function(){r.removeEventListener("error",i),r.removeEventListener("load",a),r=null},i=function(){const l="couldn't load image: "+e;sl(l),n(l,r),s()},a=function(){n(null,r),s()};return r.addEventListener("error",i),r.addEventListener("load",a),r.src=e,r}else if(typeof ImageBitmap<"u"){let s,i;const a=function(){n(s,i)},o={};t&&(o.mode="cors"),fetch(e,o).then(function(l){if(!l.ok)throw l;return l.blob()}).then(function(l){return createImageBitmap(l,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}).then(function(l){i=l,setTimeout(a)}).catch(function(l){s=l,setTimeout(a)}),r=null}return r}function Ml(e){return typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof ImageData<"u"&&e instanceof ImageData||typeof HTMLElement<"u"&&e instanceof HTMLElement}function ci(e,t,n){return Ml(e)?(setTimeout(function(){n(null,e)}),e):th(e,t,n)}function fi(e,t,n){n=n||ht.textureOptions;const r=n.target||Ge;if(e.bindTexture(r,t),n.color===!1)return;const s=Z0(n.color);if(r===Le)for(let i=0;i<6;++i)e.texImage2D(Pr+i,0,q,1,1,0,q,X,s);else r===mt||r===dt?e.texImage3D(r,0,q,1,1,1,0,q,X,s):e.texImage2D(r,0,q,1,1,0,q,X,s)}function nh(e,t,n,r){return r=r||$n,n=n||ht.textureOptions,fi(e,t,n),n=ui(e,n),ci(n.src,n.crossOrigin,function(i,a){i?r(i,t,a):(Dl(e,t,a,n),r(null,t,a))})}function rh(e,t,n,r){r=r||$n;const s=n.src;if(s.length!==6)throw new Error("there must be 6 urls for a cubemap");const i=n.level||0,a=n.internalFormat||n.format||q,o=pn(a),l=n.format||o.format,u=n.type||X,f=n.target||Ge;if(f!==Le)throw new Error("target must be TEXTURE_CUBE_MAP");fi(e,t,n),n=ui(e,n);let h=6;const c=[],d=As(e,n);let m;function _(v){return function(x,E){--h,x?c.push(x):E.width!==E.height?c.push("cubemap face img is not a square: "+E.src):it(e,n,()=>{e.bindTexture(f,t),h===5?As().forEach(function(g){e.texImage2D(g,i,a,l,u,E)}):e.texImage2D(v,i,a,l,u,E),Vn(n)&&e.generateMipmap(f)}),h===0&&r(c.length?c:void 0,t,m)}}m=s.map(function(v,x){return ci(v,n.crossOrigin,_(d[x]))})}function sh(e,t,n,r){r=r||$n;const s=n.src,i=n.internalFormat||n.format||q,a=pn(i),o=n.format||a.format,l=n.type||X,u=n.target||dt;if(u!==mt&&u!==dt)throw new Error("target must be TEXTURE_3D or TEXTURE_2D_ARRAY");fi(e,t,n),n=ui(e,n);let f=s.length;const h=[];let c;const d=n.level||0;let m=n.width,_=n.height;const v=s.length;let x=!0;function E(g){return function(R,b){--f,R?h.push(R):it(e,n,()=>{if(e.bindTexture(u,t),x){x=!1,m=n.width||b.width,_=n.height||b.height,e.texImage3D(u,d,i,m,_,v,0,o,l,null);for(let A=0;A<v;++A)e.texSubImage3D(u,d,0,0,A,m,_,1,o,l,b)}else{let A=b,F;(b.width!==m||b.height!==_)&&(F=El(),A=F.canvas,F.canvas.width=m,F.canvas.height=_,F.drawImage(b,0,0,m,_)),e.texSubImage3D(u,d,0,0,g,m,_,1,o,l,A),F&&A===F.canvas&&(F.canvas.width=0,F.canvas.height=0)}Vn(n)&&e.generateMipmap(u)}),f===0&&r(h.length?h:void 0,t,c)}}c=s.map(function(g,R){return ci(g,n.crossOrigin,E(R))})}function ih(e,t,n,r){r=r||ht.textureOptions;const s=r.target||Ge;e.bindTexture(s,t);const i=r.level||0,a=r.internalFormat||r.format||q,o=pn(a),l=r.format||o.format,u=r.type||Il(e,n,o.type);if(fn(n))n instanceof Uint8ClampedArray&&(n=new Uint8Array(n.buffer));else{const _=rl(u);n=new _(n)}const{width:f,height:h,depth:c}=oh(s,n,r,a,l,u),d=wl(a);Pl(e),e.pixelStorei(li,r.unpackAlignment||1);let m=0;return it(e,r,()=>{let _=0;const{blockWidth:v,blockHeight:x,bytesPerBlock:E}=W0(a,u);for(;_<n.byteLength;){const g=Math.max(1,f>>m),R=Math.max(1,h>>m),b=s===Ge?Math.max(1,c>>m):c,A=Math.ceil(g/v),F=Math.ceil(R/x),P=s===Le?6:1,y=A*F*E*b*P;if(_+y>n.byteLength)throw new Error("src size does not match number of mip levels");const T=n.subarray(_/n.BYTES_PER_ELEMENT,(_+y)/n.BYTES_PER_ELEMENT),C=i+m;if(s===Le){const K=T.length/6;Ts(e,r).forEach(Z=>{const me=K*Z.ndx,be=T.subarray(me,me+K);d?e.compressedTexImage2D(Z.face,C,a,g,R,0,be):e.texImage2D(Z.face,C,a,g,R,0,l,u,be)})}else s===mt||s===dt?e.texImage3D(s,C,a,g,R,b,0,l,u,T):d?e.compressedTexImage2D(s,C,a,g,R,0,T):e.texImage2D(s,C,a,g,R,0,l,u,T);if(++m,_+=y,g===1&&R===1&&b===1&&_!==n.byteLength)throw new Error("src size has more data than can fit in mip levels")}}),{width:f,height:h,depth:c,type:u,lastMipLevelUploaded:i+m-1}}function oh(e,t,n,r,s,i){let a=n.width,o=n.height,l=n.depth;const u=wl(r);if(u){if(!a||!o)throw new Error("compressed texture needs to set width and height!");l=l||1}else{const f=Fl(r,i),h=t.byteLength/f;if(h%1)throw new Error(`length wrong size for format: ${gl(Pn,s)}`);if(u&&(!a||!o))throw new Error("compressed texture needs to set width and height!");let c;if(e===mt||e===dt)if(!a&&!o&&!l){const d=Math.cbrt(h);if(d%1!==0)throw new Error(`can't guess cube size of array of numElements: ${h}`);a=d,o=d,l=d}else a&&(!o||!l)?(c=er(Pn,e,o,l,h/a),o=c.width,l=c.height):o&&(!a||!l)?(c=er(Pn,e,a,l,h/o),a=c.width,l=c.height):(c=er(Pn,e,a,o,h/l),a=c.width,o=c.height);else c=er(Pn,e,a,o,h),a=c.width,o=c.height}return{width:a,height:o,depth:l}}function ah(e,t,n){const r=n.target||Ge;e.bindTexture(r,t);const s=n.level||0,i=n.internalFormat||n.format||q,a=pn(i),o=n.format||a.format,l=n.type||a.type;it(e,n,()=>{if(r===Le)for(let u=0;u<6;++u)e.texImage2D(Pr+u,s,i,n.width,n.height,0,o,l,null);else r===mt||r===dt?e.texImage3D(r,s,i,n.width,n.height,n.depth,0,o,l,null):e.texImage2D(r,s,i,n.width,n.height,0,o,l,null)})}function Nl(e,t,n){n=n||$n,t=t||ht.textureOptions;const r=e.createTexture(),s=t.target||Ge;let i=t.width||1,a=t.height||1,o=0;const l=t.internalFormat||q;e.bindTexture(s,r),s===Le&&(e.texParameteri(s,dr,ur),e.texParameteri(s,hr,ur));let u=t.src;if(u)if(typeof u=="function"&&(u=u(e,t)),typeof u=="string")nh(e,r,t,n);else if(fn(u)||Array.isArray(u)&&(typeof u[0]=="number"||Array.isArray(u[0])||fn(u[0]))){const f=ih(e,r,u,t);i=f.width,a=f.height,o=f.lastMipLevelUploaded}else Array.isArray(u)&&(typeof u[0]=="string"||Ml(u[0]))?s===Le?rh(e,r,t,n):sh(e,r,t,n):(Dl(e,r,u,t),i=u.width,a=u.height);else ah(e,r,t);return Vn(t)&&Cl(e,r,{options:t,width:i,height:a,internalFormat:l,lastMipLevelUploaded:o}),Bl(e,r,t),r}function kl(e,t,n,r,s,i){r=r||n.width,s=s||n.height,i=i||n.depth;const a=n.target||Ge;e.bindTexture(a,t);const o=n.level||0,l=n.internalFormat||n.format||q,u=pn(l),f=n.format||u.format;let h;const c=n.src;if(c&&(fn(c)||Array.isArray(c)&&typeof c[0]=="number")?h=n.type||Il(e,c,u.type):h=n.type||u.type,a===Le)for(let d=0;d<6;++d)e.texImage2D(Pr+d,o,l,r,s,0,f,h,null);else a===mt||a===dt?e.texImage3D(a,o,l,r,s,i,0,f,h,null):e.texImage2D(a,o,l,r,s,0,f,h,null)}const di=sl;function Gl(e){return typeof document<"u"&&document.getElementById?document.getElementById(e):null}const mr=33984,Br=34962,lh=34963,uh=35713,ch=35714,fh=35632,dh=35633,hh=35981,Ll=35718,mh=35721,_h=35971,vh=35382,ph=35396,xh=35398,bh=35392,gh=35395,Cr=5126,Ul=35664,Ol=35665,Vl=35666,hi=5124,Hl=35667,zl=35668,Xl=35669,$l=35670,ql=35671,Yl=35672,Kl=35673,Wl=35674,jl=35675,Ql=35676,Eh=35678,yh=35680,Rh=35679,Sh=35682,Ah=35685,Th=35686,Fh=35687,wh=35688,Ih=35689,Ph=35690,Bh=36289,Ch=36292,Dh=36293,mi=5125,Zl=36294,Jl=36295,eu=36296,Mh=36298,Nh=36299,kh=36300,Gh=36303,Lh=36306,Uh=36307,Oh=36308,Vh=36311,Dr=3553,Mr=34067,_i=32879,Nr=35866,B={};function tu(e,t){return B[t].bindPoint}function Hh(e,t){return function(n){e.uniform1f(t,n)}}function zh(e,t){return function(n){e.uniform1fv(t,n)}}function Xh(e,t){return function(n){e.uniform2fv(t,n)}}function $h(e,t){return function(n){e.uniform3fv(t,n)}}function qh(e,t){return function(n){e.uniform4fv(t,n)}}function nu(e,t){return function(n){e.uniform1i(t,n)}}function ru(e,t){return function(n){e.uniform1iv(t,n)}}function su(e,t){return function(n){e.uniform2iv(t,n)}}function iu(e,t){return function(n){e.uniform3iv(t,n)}}function ou(e,t){return function(n){e.uniform4iv(t,n)}}function Yh(e,t){return function(n){e.uniform1ui(t,n)}}function Kh(e,t){return function(n){e.uniform1uiv(t,n)}}function Wh(e,t){return function(n){e.uniform2uiv(t,n)}}function jh(e,t){return function(n){e.uniform3uiv(t,n)}}function Qh(e,t){return function(n){e.uniform4uiv(t,n)}}function Zh(e,t){return function(n){e.uniformMatrix2fv(t,!1,n)}}function Jh(e,t){return function(n){e.uniformMatrix3fv(t,!1,n)}}function em(e,t){return function(n){e.uniformMatrix4fv(t,!1,n)}}function tm(e,t){return function(n){e.uniformMatrix2x3fv(t,!1,n)}}function nm(e,t){return function(n){e.uniformMatrix3x2fv(t,!1,n)}}function rm(e,t){return function(n){e.uniformMatrix2x4fv(t,!1,n)}}function sm(e,t){return function(n){e.uniformMatrix4x2fv(t,!1,n)}}function im(e,t){return function(n){e.uniformMatrix3x4fv(t,!1,n)}}function om(e,t){return function(n){e.uniformMatrix4x3fv(t,!1,n)}}function ue(e,t,n,r){const s=tu(e,t);return Xn(e)?function(i){let a,o;!i||Tr(e,i)?(a=i,o=null):(a=i.texture,o=i.sampler),e.uniform1i(r,n),e.activeTexture(mr+n),e.bindTexture(s,a),e.bindSampler(n,o)}:function(i){e.uniform1i(r,n),e.activeTexture(mr+n),e.bindTexture(s,i)}}function ce(e,t,n,r,s){const i=tu(e,t),a=new Int32Array(s);for(let o=0;o<s;++o)a[o]=n+o;return Xn(e)?function(o){e.uniform1iv(r,a),o.forEach(function(l,u){e.activeTexture(mr+a[u]);let f,h;!l||Tr(e,l)?(f=l,h=null):(f=l.texture,h=l.sampler),e.bindSampler(n,h),e.bindTexture(i,f)})}:function(o){e.uniform1iv(r,a),o.forEach(function(l,u){e.activeTexture(mr+a[u]),e.bindTexture(i,l)})}}B[Cr]={Type:Float32Array,size:4,setter:Hh,arraySetter:zh};B[Ul]={Type:Float32Array,size:8,setter:Xh,cols:2};B[Ol]={Type:Float32Array,size:12,setter:$h,cols:3};B[Vl]={Type:Float32Array,size:16,setter:qh,cols:4};B[hi]={Type:Int32Array,size:4,setter:nu,arraySetter:ru};B[Hl]={Type:Int32Array,size:8,setter:su,cols:2};B[zl]={Type:Int32Array,size:12,setter:iu,cols:3};B[Xl]={Type:Int32Array,size:16,setter:ou,cols:4};B[mi]={Type:Uint32Array,size:4,setter:Yh,arraySetter:Kh};B[Zl]={Type:Uint32Array,size:8,setter:Wh,cols:2};B[Jl]={Type:Uint32Array,size:12,setter:jh,cols:3};B[eu]={Type:Uint32Array,size:16,setter:Qh,cols:4};B[$l]={Type:Uint32Array,size:4,setter:nu,arraySetter:ru};B[ql]={Type:Uint32Array,size:8,setter:su,cols:2};B[Yl]={Type:Uint32Array,size:12,setter:iu,cols:3};B[Kl]={Type:Uint32Array,size:16,setter:ou,cols:4};B[Wl]={Type:Float32Array,size:32,setter:Zh,rows:2,cols:2};B[jl]={Type:Float32Array,size:48,setter:Jh,rows:3,cols:3};B[Ql]={Type:Float32Array,size:64,setter:em,rows:4,cols:4};B[Ah]={Type:Float32Array,size:32,setter:tm,rows:2,cols:3};B[Th]={Type:Float32Array,size:32,setter:rm,rows:2,cols:4};B[Fh]={Type:Float32Array,size:48,setter:nm,rows:3,cols:2};B[wh]={Type:Float32Array,size:48,setter:im,rows:3,cols:4};B[Ih]={Type:Float32Array,size:64,setter:sm,rows:4,cols:2};B[Ph]={Type:Float32Array,size:64,setter:om,rows:4,cols:3};B[Eh]={Type:null,size:0,setter:ue,arraySetter:ce,bindPoint:Dr};B[yh]={Type:null,size:0,setter:ue,arraySetter:ce,bindPoint:Mr};B[Rh]={Type:null,size:0,setter:ue,arraySetter:ce,bindPoint:_i};B[Sh]={Type:null,size:0,setter:ue,arraySetter:ce,bindPoint:Dr};B[Bh]={Type:null,size:0,setter:ue,arraySetter:ce,bindPoint:Nr};B[Ch]={Type:null,size:0,setter:ue,arraySetter:ce,bindPoint:Nr};B[Dh]={Type:null,size:0,setter:ue,arraySetter:ce,bindPoint:Mr};B[Mh]={Type:null,size:0,setter:ue,arraySetter:ce,bindPoint:Dr};B[Nh]={Type:null,size:0,setter:ue,arraySetter:ce,bindPoint:_i};B[kh]={Type:null,size:0,setter:ue,arraySetter:ce,bindPoint:Mr};B[Gh]={Type:null,size:0,setter:ue,arraySetter:ce,bindPoint:Nr};B[Lh]={Type:null,size:0,setter:ue,arraySetter:ce,bindPoint:Dr};B[Uh]={Type:null,size:0,setter:ue,arraySetter:ce,bindPoint:_i};B[Oh]={Type:null,size:0,setter:ue,arraySetter:ce,bindPoint:Mr};B[Vh]={Type:null,size:0,setter:ue,arraySetter:ce,bindPoint:Nr};function kr(e,t){return function(n){if(n.value)switch(e.disableVertexAttribArray(t),n.value.length){case 4:e.vertexAttrib4fv(t,n.value);break;case 3:e.vertexAttrib3fv(t,n.value);break;case 2:e.vertexAttrib2fv(t,n.value);break;case 1:e.vertexAttrib1fv(t,n.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else e.bindBuffer(Br,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,n.numComponents||n.size,n.type||Cr,n.normalize||!1,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function _t(e,t){return function(n){if(n.value)if(e.disableVertexAttribArray(t),n.value.length===4)e.vertexAttrib4iv(t,n.value);else throw new Error("The length of an integer constant value must be 4!");else e.bindBuffer(Br,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,n.numComponents||n.size,n.type||hi,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function Gr(e,t){return function(n){if(n.value)if(e.disableVertexAttribArray(t),n.value.length===4)e.vertexAttrib4uiv(t,n.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else e.bindBuffer(Br,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,n.numComponents||n.size,n.type||mi,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function vi(e,t,n){const r=n.size,s=n.count;return function(i){e.bindBuffer(Br,i.buffer);const a=i.size||i.numComponents||r,o=a/s,l=i.type||Cr,f=B[l].size*a,h=i.normalize||!1,c=i.offset||0,d=f/s;for(let m=0;m<s;++m)e.enableVertexAttribArray(t+m),e.vertexAttribPointer(t+m,o,l,h,f,c+d*m),e.vertexAttribDivisor&&e.vertexAttribDivisor(t+m,i.divisor||0)}}const j={};j[Cr]={size:4,setter:kr};j[Ul]={size:8,setter:kr};j[Ol]={size:12,setter:kr};j[Vl]={size:16,setter:kr};j[hi]={size:4,setter:_t};j[Hl]={size:8,setter:_t};j[zl]={size:12,setter:_t};j[Xl]={size:16,setter:_t};j[mi]={size:4,setter:Gr};j[Zl]={size:8,setter:Gr};j[Jl]={size:12,setter:Gr};j[eu]={size:16,setter:Gr};j[$l]={size:4,setter:_t};j[ql]={size:8,setter:_t};j[Yl]={size:12,setter:_t};j[Kl]={size:16,setter:_t};j[Wl]={size:4,setter:vi,count:2};j[jl]={size:9,setter:vi,count:3};j[Ql]={size:16,setter:vi,count:4};const am=/ERROR:\s*\d+:(\d+)/gi;function lm(e,t="",n=0){const r=[...t.matchAll(am)],s=new Map(r.map((i,a)=>{const o=parseInt(i[1]),l=r[a+1],u=l?l.index:t.length,f=t.substring(i.index,u);return[o-1,f]}));return e.split(`
`).map((i,a)=>{const o=s.get(a);return`${a+1+n}: ${i}${o?`

^^^ ${o}`:""}`}).join(`
`)}const ua=/^[ \t]*\n/;function au(e){let t=0;return ua.test(e)&&(t=1,e=e.replace(ua,"")),{lineOffset:t,shaderSource:e}}function um(e,t){return e.errorCallback(t),e.callback&&setTimeout(()=>{e.callback(`${t}
${e.errors.join(`
`)}`)}),null}function cm(e,t,n,r){if(r=r||di,!e.getShaderParameter(n,uh)){const i=e.getShaderInfoLog(n),{lineOffset:a,shaderSource:o}=au(e.getShaderSource(n)),l=`${lm(o,i,a)}
Error compiling ${gl(e,t)}: ${i}`;return r(l),l}return""}function pi(e,t,n){let r,s,i;if(typeof t=="function"&&(n=t,t=void 0),typeof e=="function")n=e,e=void 0;else if(e&&!Array.isArray(e)){const u=e;n=u.errorCallback,e=u.attribLocations,r=u.transformFeedbackVaryings,s=u.transformFeedbackMode,i=u.callback}const a=n||di,o=[],l={errorCallback(u,...f){o.push(u),a(u,...f)},transformFeedbackVaryings:r,transformFeedbackMode:s,callback:i,errors:o};{let u={};Array.isArray(e)?e.forEach(function(f,h){u[f]=t?t[h]:h}):u=e||{},l.attribLocations=u}return l}const fm=["VERTEX_SHADER","FRAGMENT_SHADER"];function dm(e,t){if(t.indexOf("frag")>=0)return fh;if(t.indexOf("vert")>=0)return dh}function hm(e,t,n){const r=e.getAttachedShaders(t);for(const s of r)n.has(s)||e.deleteShader(s);e.deleteProgram(t)}const mm=(e=0)=>new Promise(t=>setTimeout(t,e));function _m(e,t,n){const r=e.createProgram(),{attribLocations:s,transformFeedbackVaryings:i,transformFeedbackMode:a}=pi(n);for(let o=0;o<t.length;++o){let l=t[o];if(typeof l=="string"){const u=Gl(l),f=u?u.text:l;let h=e[fm[o]];u&&u.type&&(h=dm(e,u.type)||h),l=e.createShader(h),e.shaderSource(l,au(f).shaderSource),e.compileShader(l)}e.attachShader(r,l)}Object.entries(s).forEach(([o,l])=>e.bindAttribLocation(r,l,o));{let o=i;o&&(o.attribs&&(o=o.attribs),Array.isArray(o)||(o=Object.keys(o)),e.transformFeedbackVaryings(r,o,a||hh))}return e.linkProgram(r),r}function vm(e,t,n,r,s){const i=pi(n,r,s),a=new Set(t),o=_m(e,t,i);function l(u,f){const h=xm(u,f,i.errorCallback);return h&&hm(u,f,a),h}if(i.callback){pm(e,o).then(()=>{const u=l(e,o);i.callback(u,u?void 0:o)});return}return l(e,o)?void 0:o}async function pm(e,t){const n=e.getExtension("KHR_parallel_shader_compile"),r=n?(i,a)=>i.getProgramParameter(a,n.COMPLETION_STATUS_KHR):()=>!0;let s=0;do await mm(s),s=1e3/60;while(!r(e,t))}function xm(e,t,n){if(n=n||di,!e.getProgramParameter(t,ch)){const s=e.getProgramInfoLog(t);n(`Error in program linking: ${s}`);const a=e.getAttachedShaders(t).map(o=>cm(e,e.getShaderParameter(o,e.SHADER_TYPE),o,n));return`${s}
${a.filter(o=>o).join(`
`)}`}}function bm(e,t,n,r,s){return vm(e,t,n,r,s)}function lu(e){const t=e.name;return t.startsWith("gl_")||t.startsWith("webgl_")}const gm=/(\.|\[|]|\w+)/g,Em=e=>e>="0"&&e<="9";function ym(e,t,n,r){const s=e.split(gm).filter(o=>o!=="");let i=0,a="";for(;;){const o=s[i++];a+=o;const l=Em(o[0]),u=l?parseInt(o):o;if(l&&(a+=s[i++]),i===s.length){n[u]=t;break}else{const h=s[i++],c=h==="[",d=n[u]||(c?[]:{});n[u]=d,n=d,r[a]=r[a]||(function(m){return function(_){uu(m,_)}})(d),a+=h}}}function Rm(e,t){let n=0;function r(o,l,u){const f=l.name.endsWith("[0]"),h=l.type,c=B[h];if(!c)throw new Error(`unknown type: 0x${h.toString(16)}`);let d;if(c.bindPoint){const m=n;n+=l.size,f?d=c.arraySetter(e,h,m,u,l.size):d=c.setter(e,h,m,u,l.size)}else c.arraySetter&&f?d=c.arraySetter(e,u):d=c.setter(e,u);return d.location=u,d}const s={},i={},a=e.getProgramParameter(t,Ll);for(let o=0;o<a;++o){const l=e.getActiveUniform(t,o);if(lu(l))continue;let u=l.name;u.endsWith("[0]")&&(u=u.substr(0,u.length-3));const f=e.getUniformLocation(t,l.name);if(f){const h=r(t,l,f);s[u]=h,ym(u,h,i,s)}}return s}function Sm(e,t){const n={},r=e.getProgramParameter(t,_h);for(let s=0;s<r;++s){const i=e.getTransformFeedbackVarying(t,s);n[i.name]={index:s,type:i.type,size:i.size}}return n}function Am(e,t){const n=e.getProgramParameter(t,Ll),r=[],s=[];for(let o=0;o<n;++o){s.push(o),r.push({});const l=e.getActiveUniform(t,o);r[o].name=l.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(o){const l=o[0],u=o[1];e.getActiveUniforms(t,s,e[l]).forEach(function(f,h){r[h][u]=f})});const i={},a=e.getProgramParameter(t,vh);for(let o=0;o<a;++o){const l=e.getActiveUniformBlockName(t,o),u={index:e.getUniformBlockIndex(t,l),usedByVertexShader:e.getActiveUniformBlockParameter(t,o,ph),usedByFragmentShader:e.getActiveUniformBlockParameter(t,o,xh),size:e.getActiveUniformBlockParameter(t,o,bh),uniformIndices:e.getActiveUniformBlockParameter(t,o,gh)};u.used=u.usedByVertexShader||u.usedByFragmentShader,i[l]=u}return{blockSpecs:i,uniformData:r}}function uu(e,t){for(const n in t){const r=e[n];typeof r=="function"?r(t[n]):uu(e[n],t[n])}}function xi(e,...t){const n=e.uniformSetters||e,r=t.length;for(let s=0;s<r;++s){const i=t[s];if(Array.isArray(i)){const a=i.length;for(let o=0;o<a;++o)xi(n,i[o])}else for(const a in i){const o=n[a];o&&o(i[a])}}}function Tm(e,t){const n={},r=e.getProgramParameter(t,mh);for(let s=0;s<r;++s){const i=e.getActiveAttrib(t,s);if(lu(i))continue;const a=e.getAttribLocation(t,i.name),o=j[i.type],l=o.setter(e,a,o);l.location=a,n[i.name]=l}return n}function Fm(e,t){for(const n in t){const r=e[n];r&&r(t[n])}}function cu(e,t,n){n.vertexArrayObject?e.bindVertexArray(n.vertexArrayObject):(Fm(t.attribSetters||t,n.attribs),n.indices&&e.bindBuffer(lh,n.indices))}function ca(e,t){const n=Rm(e,t),r=Tm(e,t),s={program:t,uniformSetters:n,attribSetters:r,uniformLocations:Object.fromEntries(Object.entries(n).map(([i,a])=>[i,a.location])),attribLocations:Object.fromEntries(Object.entries(r).map(([i,a])=>[i,a.location]))};return Xn(e)&&(s.uniformBlockSpec=Am(e,t),s.transformFeedbackInfo=Sm(e,t)),s}const wm=/\s|{|}|;/;function Im(e,t,n,r,s){const i=pi(n,r,s),a=[];if(t=t.map(function(u){if(!wm.test(u)){const f=Gl(u);if(f)u=f.text;else{const h=`no element with id: ${u}`;i.errorCallback(h),a.push(h)}}return u}),a.length)return um(i,"");const o=i.callback;o&&(i.callback=(u,f)=>{o(u,u?void 0:ca(e,f))});const l=bm(e,t,i);return l?ca(e,l):null}const Pm=4,fa=5123;function fu(e,t,n,r,s,i){n=n===void 0?Pm:n;const a=t.indices,o=t.elementType,l=r===void 0?t.numElements:r;s=s===void 0?0:s,o||a?i!==void 0?e.drawElementsInstanced(n,l,o===void 0?fa:t.elementType,s,i):e.drawElements(n,l,o===void 0?fa:t.elementType,s):i!==void 0?e.drawArraysInstanced(n,s,l,i):e.drawArrays(n,s,l)}const du=36160,St=36161,Bm=3553,Cm=5121,Dm=6402,Mm=6408,Nm=33190,km=36012,Gm=35056,Lm=36013,Um=32854,Om=32855,Vm=36194,hu=33189,mu=6401,_u=36168,bi=34041,Fs=36064,Lr=36096,vu=36128,gi=33306,ws=33071,Is=9729,pu=[{format:Mm,type:Cm,min:Is,wrap:ws},{format:bi}],we={};we[bi]=gi;we[mu]=vu;we[_u]=vu;we[Dm]=Lr;we[hu]=Lr;we[Nm]=Lr;we[km]=Lr;we[Gm]=gi;we[Lm]=gi;function Hm(e,t){return we[e]||we[t]}const vt={};vt[Um]=!0;vt[Om]=!0;vt[Vm]=!0;vt[bi]=!0;vt[hu]=!0;vt[mu]=!0;vt[_u]=!0;function zm(e){return vt[e]}const Xm=32;function $m(e){return e>=Fs&&e<Fs+Xm}function qm(e,t,n,r){const s=du,i=e.createFramebuffer();e.bindFramebuffer(s,i),n=n||e.drawingBufferWidth,r=r||e.drawingBufferHeight,t=t||pu;const a=[],o={framebuffer:i,attachments:[],width:n,height:r};return t.forEach(function(l,u){let f=l.attachment;const h=l.samples,c=l.format;let d=l.attachmentPoint||Hm(c,l.internalFormat);if(d||(d=Fs+u),$m(d)&&a.push(d),!f)if(h!==void 0||zm(c))f=e.createRenderbuffer(),e.bindRenderbuffer(St,f),h>1?e.renderbufferStorageMultisample(St,h,c,n,r):e.renderbufferStorage(St,c,n,r);else{const m=Object.assign({},l);m.width=n,m.height=r,m.auto===void 0&&(m.auto=!1,m.min=m.min||m.minMag||Is,m.mag=m.mag||m.minMag||Is,m.wrapS=m.wrapS||m.wrap||ws,m.wrapT=m.wrapT||m.wrap||ws),f=Nl(e,m)}if(il(e,f))e.framebufferRenderbuffer(s,d,St,f);else if(Tr(e,f))l.layer!==void 0?e.framebufferTextureLayer(s,d,f,l.level||0,l.layer):e.framebufferTexture2D(s,d,l.target||Bm,f,l.level||0);else throw new Error("unknown attachment type");o.attachments.push(f)}),e.drawBuffers&&e.drawBuffers(a),o}function Ym(e,t,n,r,s){r=r||e.drawingBufferWidth,s=s||e.drawingBufferHeight,t.width=r,t.height=s,n=n||pu,n.forEach(function(i,a){const o=t.attachments[a],l=i.format,u=i.samples;if(u!==void 0||il(e,o))e.bindRenderbuffer(St,o),u>1?e.renderbufferStorageMultisample(St,u,l,r,s):e.renderbufferStorage(St,l,r,s);else if(Tr(e,o))kl(e,o,i,r,s);else throw new Error("unknown attachment type")})}function da(e,t,n){n=n||du,t?(e.bindFramebuffer(n,t.framebuffer),e.viewport(0,0,t.width,t.height)):(e.bindFramebuffer(n,null),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight))}class W{constructor(t,n,r,s){this.gl=t,this.internalFormat=n,this.format=r,this.texture=Nl(t,{width:t.canvas.width,height:t.canvas.height,internalFormat:n,format:r,type:t.UNSIGNED_BYTE,minMag:s,wrap:t.CLAMP_TO_EDGE}),this.framebufferInfo=qm(t,[{attachment:this.texture}],t.canvas.width,t.canvas.height)}framebufferInfo;texture;get isRGBA8(){return this.internalFormat===this.gl.RGBA8&&this.format===this.gl.RGBA}get isR8(){return this.internalFormat===this.gl.R8&&this.format===this.gl.RED}static createRGBA8(t,n=t.LINEAR){return new W(t,t.RGBA8,t.RGBA,n)}static createRGB8(t,n=t.LINEAR){return new W(t,t.RGB8,t.RGB,n)}static createR8(t,n=t.LINEAR){return new W(t,t.R8,t.RED,n)}resize(t,n){kl(this.gl,this.texture,{width:t,height:n}),Ym(this.gl,this.framebufferInfo,[{attachment:this.texture}],t,n)}}class Km{constructor(t){this.canvas=t;const n=t.getContext("webgl2");if(!n)throw new Error("WebGL2 not available for pipeline");this.gl=n,this.bitmapRenderTarget=W.createRGBA8(n)}passChain=[];bitmapRenderTarget;gl;addPass(t){this.passChain.push(t)}applyBitmap(t,n){this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,n)}resize(t,n){this.canvas.width=t,this.canvas.height=n,this.bitmapRenderTarget.resize(t,n)}postprocess(t){}async render(t){(this.canvas.width!==t.width||this.canvas.height!==t.height)&&this.resize(t.width,t.height),this.applyBitmap(this.bitmapRenderTarget.texture,t);const n=this.passChain.filter(a=>a.enabled);if(n.length===0)throw new Error("No passes in pipeline");let r=this.bitmapRenderTarget;for(let a=0;a<n.length-1;a++)r=n[a].apply(r);const i=n[n.length-1].applyToScreen(r)??r;return this.postprocess(i)}}const Wm=`#version 300 es

in vec2 position;
in vec2 texcoord;

out vec2 v_uv;

void main() {
  v_uv = texcoord;
  gl_Position = vec4(position, 0.0, 1.0);
}`;class xn{constructor(t,n){this.gl=t,this.settings=n,this.quadBufferInfo=bl.createXYQuadBufferInfo(t)}get enabled(){return this.settings.enabled}set enabled(t){this.settings.enabled=t}quadBufferInfo;apply(t){return this.applyInternal(t,!1)}applyToScreen(t){return this.applyInternal(t,!0)}executeProgram(t,n,r,s=!1){this.settings.input=n.texture,t.uniformSetters.u_texelSize&&this.settings.setTextelSize(n.framebufferInfo.width,n.framebufferInfo.height),r&&!s&&(r.framebufferInfo.width!==this.gl.canvas.width||r.framebufferInfo.height!==this.gl.canvas.height)&&r.resize(this.gl.canvas.width,this.gl.canvas.height);const i=r?r.framebufferInfo.width:this.gl.canvas.width,a=r?r.framebufferInfo.height:this.gl.canvas.height;r?da(this.gl,r.framebufferInfo):da(this.gl,null),this.gl.useProgram(t.program),this.gl.viewport(0,0,i,a),cu(this.gl,t,this.quadBufferInfo),xi(t,this.settings.uniforms),fu(this.gl,this.quadBufferInfo)}createProgramInfo(t){return Im(this.gl,[Wm,t])}}const jm=`#version 300 es
precision highp float;

in vec2 v_uv;

uniform sampler2D u_input;        // R8 luma input
uniform vec2      u_texelSize;    // 1 / texture resolution

uniform float u_sigmaSpatial;     // spatial Gaussian sigma
uniform float u_sigmaRange;       // range (luma) Gaussian sigma
uniform int   u_kernelRadius;     // must be <= MAX_KERNEL_RADIUS

out vec4 outColor;

const int MAX_KERNEL_RADIUS = 5;

void main() {

    vec2 uv = v_uv;

    // Center pixel (luma)
    float centerLuma = texture(u_input, uv).r;

    float weightedSum = 0.0;
    float weightTotal = 0.0;

    // Precompute inverse variances
    float invSpatialVar = 1.0 / (2.0 * u_sigmaSpatial * u_sigmaSpatial);
    float invRangeVar   = 1.0 / (2.0 * u_sigmaRange   * u_sigmaRange);

    for (int ky = -MAX_KERNEL_RADIUS; ky <= MAX_KERNEL_RADIUS; ++ky) {
        for (int kx = -MAX_KERNEL_RADIUS; kx <= MAX_KERNEL_RADIUS; ++kx) {

            // Branchless kernel mask
            float maskX = step(float(abs(kx)), float(u_kernelRadius));
            float maskY = step(float(abs(ky)), float(u_kernelRadius));
            float kernelMask = maskX * maskY;

            vec2 offsetTexel =
                vec2(float(kx), float(ky)) * u_texelSize;

            float neighborLuma =
                texture(u_input, uv + offsetTexel).r;

            float spatialDist2 =
                float(kx * kx + ky * ky);

            float rangeDist2 =
                (neighborLuma - centerLuma) *
                (neighborLuma - centerLuma);

            float weightSpatial =
                exp(-spatialDist2 * invSpatialVar);

            float weightRange =
                exp(-rangeDist2 * invRangeVar);

            float kernelWeight =
                weightSpatial * weightRange * kernelMask;

            weightedSum += neighborLuma * kernelWeight;
            weightTotal += kernelWeight;
        }
    }

    float filteredLuma = weightedSum / weightTotal;

    outColor = vec4(filteredLuma,
                    filteredLuma,
                    filteredLuma,
                    1.0);
}
`;class Qm extends xn{bilateralProgramInfo;outputRenderTarget;constructor(t,n){super(t,n),this.bilateralProgramInfo=this.createProgramInfo(jm),this.outputRenderTarget=W.createR8(t)}applyInternal(t,n){if(!t.isR8)throw new Error("BilateralPass only supports R8 render targets");return this.executeProgram(this.bilateralProgramInfo,t,n?null:this.outputRenderTarget),this.outputRenderTarget}}class bn{_enabled=!0;get enabled(){return this._enabled}set enabled(t){this._enabled=t}get input(){return this.uniforms.u_input}set input(t){this.uniforms.u_input=t}get textelSize(){return this.uniforms.u_texelSize}setTextelSize(t,n){this.uniforms.u_texelSize=[1/t,1/n]}uniforms={}}class Zm extends bn{get sigmaSpatial(){return this.uniforms.u_sigmaSpatial}set sigmaSpatial(t){this.uniforms.u_sigmaSpatial=t}get sigmaRange(){return this.uniforms.u_sigmaRange}set sigmaRange(t){this.uniforms.u_sigmaRange=t}get kernelRadius(){return this.uniforms.u_kernelRadius}set kernelRadius(t){this.uniforms.u_kernelRadius=t}}const Jm=`#version 300 es
precision highp float;

in vec2 v_uv;
uniform sampler2D u_input;

out vec4 outColor;

void main() {
    vec3 color = texture(u_input, v_uv).rgb;

    // Rec.709 luma
    float luma = dot(color, vec3(
        0.2126,  // R
        0.7152,  // G
        0.0722   // B
    ));

    outColor = vec4(luma, luma, luma, 1.0);
}
`;class e_ extends xn{lum709ProgramInfo;outputRenderTarget;constructor(t){super(t,new bn),this.lum709ProgramInfo=this.createProgramInfo(Jm),this.outputRenderTarget=W.createR8(t)}applyInternal(t,n){if(!t.isRGBA8)throw new Error("Rec709LumPass only supports RGBA8 render targets");return this.executeProgram(this.lum709ProgramInfo,t,n?null:this.outputRenderTarget),this.outputRenderTarget}}const t_=`#version 300 es
precision highp float;

in vec2 v_uv;
uniform sampler2D u_input;
uniform int u_flipX;
uniform int u_flipY;

out vec4 outColor;

void main() {
    vec2 uv = v_uv;
    if (u_flipX == 1) uv.x = 1.0 - uv.x;
    if (u_flipY == 1) uv.y = 1.0 - uv.y;
    outColor = texture(u_input, uv);
}
`;class n_ extends xn{programInfo;outputRenderTarget;constructor(t,n){super(t,n),this.programInfo=this.createProgramInfo(t_),this.outputRenderTarget=W.createR8(t)}applyInternal(t,n){if(!t.isR8)throw new Error("OrientationPass expects R8 render targets");return this.executeProgram(this.programInfo,t,n?null:this.outputRenderTarget),this.outputRenderTarget}}class r_ extends bn{get flipX(){return!!this.uniforms.u_flipX}set flipX(t){this.uniforms.u_flipX=t?1:0}get flipY(){return!!this.uniforms.u_flipY}set flipY(t){this.uniforms.u_flipY=t?1:0}}const ha=`#version 300 es
precision highp float;

in vec2 v_uv;

uniform sampler2D u_input;
uniform vec2      u_texelSize;

out vec4 outColor;

const float sobelDerivative[5] = float[5](
    -2.0, -1.0, 0.0, 1.0, 2.0
);

const float sobelSmoothing[5] = float[5](
     1.0,  4.0, 6.0, 4.0, 1.0
);

const float SOBEL_G_MAX   = 48.0;
const float SOBEL_MAG_MAX = 51.264022471905186;

float encodeSnorm8(float v)
{
    return clamp(v * 0.5 + 0.5, 0.0, 1.0);
}

vec2 encodeUNorm16(float v)
{
    float x = clamp(v, 0.0, 1.0);
    float hi = floor(x * 65535.0 / 256.0);
    float lo = floor(x * 65535.0 - hi * 256.0);
    return vec2(hi, lo) / 255.0;
}

void main()
{
    float gx = 0.0;
    float gy = 0.0;

    for (int y = 0; y < 5; y++)
    {
        for (int x = 0; x < 5; x++)
        {
            vec2 o = vec2(float(x - 2), float(y - 2)) * u_texelSize;
            float l = texture(u_input, v_uv + o).r;

            gx += l * sobelDerivative[x] * sobelSmoothing[y];
            gy += l * sobelSmoothing[x] * sobelDerivative[y];
        }
    }

    // Signed int8-normalized gx/gy
    float gxN = clamp(gx / SOBEL_G_MAX, -1.0, 1.0);
    float gyN = clamp(gy / SOBEL_G_MAX, -1.0, 1.0);

    float mag = length(vec2(gx, gy));
    float magN = mag / SOBEL_MAG_MAX;

    vec2 magBA = encodeUNorm16(magN);

    outColor = vec4(
        encodeSnorm8(gxN),
        encodeSnorm8(gyN),
        magBA.x,
        magBA.y
    );
}
`,s_=`#version 300 es
precision highp float;

in vec2 v_uv;

uniform sampler2D u_input;

out vec4 outColor;

// --- decoders ---

float decodeSnorm8(float v)
{
    return v * 2.0 - 1.0;
}

float decodeUNorm16(vec2 ba)
{
    float hi = ba.x * 255.0;
    float lo = ba.y * 255.0;
    return (hi * 256.0 + lo) / 65535.0;
}

// --- half pack ---

vec4 packHalf2x16ToRGBA8(float x, float y)
{
    uint bits = packHalf2x16(vec2(x, y));

    return vec4(
        float((bits >> 24) & 0xFFu) / 255.0,
        float((bits >> 16) & 0xFFu) / 255.0,
        float((bits >>  8) & 0xFFu) / 255.0,
        float((bits >>  0) & 0xFFu) / 255.0
    );
}

void main()
{
    vec4 packed = texture(u_input, v_uv);

    // Decode signed gradients (normalized)
    float gx = decodeSnorm8(packed.r);
    float gy = decodeSnorm8(packed.g);

    // Decode normalized magnitude (optional use)
    float mag = decodeUNorm16(packed.ba);

    // Protect against zero vector
    float len = max(length(vec2(gx, gy)), 1e-6);

    vec2 dir = vec2(gx, gy) / len;

    // Store direction as half floats
    outColor = packHalf2x16ToRGBA8(dir.x, dir.y);
}
`,i_=`#version 300 es
precision highp float;

in vec2 v_uv;

uniform sampler2D u_input;      // Input luma texture (luma in .r)
uniform vec2      u_texelSize;  // 1.0 / texture resolution

uniform float u_sigmaSmall;
uniform float u_sigmaLarge;

uniform float u_sigmaSmallWeights[19];
uniform float u_sigmaLargeWeights[19];

out vec4 outColor;

/*
    Hard cap to keep footprint bounded.
*/
const float MAX_SIGMA_LARGE = 3.0;
const int   GAUSSIAN_RADIUS = 9;

vec4 packFloatToRGBA8(float v)
{
    uint bits = floatBitsToUint(v);

    uint r = (bits >> 24) & 0xFFu;
    uint g = (bits >> 16) & 0xFFu;
    uint b = (bits >>  8) & 0xFFu;
    uint a = (bits >>  0) & 0xFFu;

    //vec4 expects floats so we still need to do this.
    return vec4(
        float(r) / 255.0,
        float(g) / 255.0,
        float(b) / 255.0,
        float(a) / 255.0
    );
}

void main()
{
    float sigmaSmall = u_sigmaSmall;
    float sigmaLarge = min(u_sigmaLarge, MAX_SIGMA_LARGE);

    float smallBlur = 0.0;
    float largeBlur = 0.0;
    for (int y = -GAUSSIAN_RADIUS; y <= GAUSSIAN_RADIUS; y++)
    {
        float smallBlurX = 0.0;
        float LargeBlurX = 0.0;
        float xLuma = 0.0;
        for (int x = -GAUSSIAN_RADIUS; x <= GAUSSIAN_RADIUS; x++)
        {
            vec2 offset = vec2(float(x) * u_texelSize.x, float(y) * u_texelSize.y);
            xLuma = texture(u_input, v_uv + offset).r;
            smallBlurX += xLuma * u_sigmaSmallWeights[x+GAUSSIAN_RADIUS];
            LargeBlurX += xLuma * u_sigmaLargeWeights[x+GAUSSIAN_RADIUS];
        }

        smallBlur += smallBlurX * u_sigmaSmallWeights[y+GAUSSIAN_RADIUS];
        largeBlur += LargeBlurX * u_sigmaLargeWeights[y+GAUSSIAN_RADIUS];
    }

    float dog = largeBlur - smallBlur;

    outColor = packFloatToRGBA8(dog);
}
`,o_=`#version 300 es
precision highp float;

in vec2 v_uv;

uniform sampler2D u_input; // sobel unit vectors (half2 packed)
uniform sampler2D u_dogs;  // DoG scalar (float packed)
uniform vec2      u_texelSize;
uniform float     u_dogThreshold;

out vec4 outColor;

// ---------- unpack helpers ----------

vec2 unpackRGBA8ToHalf2x16(vec4 rgba)
{
    uint r = uint(round(rgba.r * 255.0));
    uint g = uint(round(rgba.g * 255.0));
    uint b = uint(round(rgba.b * 255.0));
    uint a = uint(round(rgba.a * 255.0));

    uint bits = (r << 24) | (g << 16) | (b << 8) | a;
    return unpackHalf2x16(bits);
}

float unpackRGBA8ToFloat(vec4 rgba)
{
    uint r = uint(round(rgba.r * 255.0));
    uint g = uint(round(rgba.g * 255.0));
    uint b = uint(round(rgba.b * 255.0));
    uint a = uint(round(rgba.a * 255.0));

    uint bits = (r << 24) | (g << 16) | (b << 8) | a;
    return uintBitsToFloat(bits);
}

vec3 packUnorm24(float v)
{
    v = clamp(v, 0.0, 1.0);
    uint u = uint(round(v * 16777215.0));

    return vec3(
        float((u >> 16) & 0xFFu) / 255.0,
        float((u >>  8) & 0xFFu) / 255.0,
        float((u >>  0) & 0xFFu) / 255.0
    );
}

// ---------- neighbor offsets ----------

const vec2 offsets[8] = vec2[8](
    vec2(-1,-1), vec2(-1,0), vec2(-1,1),
    vec2( 0,-1),             vec2( 0,1),
    vec2( 1,-1), vec2( 1,0), vec2( 1,1)
);

void main()
{
    // Center data
    vec2 centerVec = unpackRGBA8ToHalf2x16(texture(u_input, v_uv));
    float centerDog = unpackRGBA8ToFloat(texture(u_dogs, v_uv));
    vec2 centerTangent = vec2(-centerVec.y, centerVec.x);

    float maxScore = 0.0;
    float bestDir  = 0.0;

    for (int i = 0; i < 8; i++)
    {
        vec2 uv = v_uv + offsets[i] * u_texelSize;

        vec2 nVec = unpackRGBA8ToHalf2x16(texture(u_input, uv));
        float nDog = unpackRGBA8ToFloat(texture(u_dogs, uv));

        // Directional agreement
        float cosine = abs(dot(centerVec, nVec));

        // Forward-only
        float forward = step(1e-6, dot(centerTangent, offsets[i]));

        // DoG filters
        float sameSign = step(0.0, centerDog * nDog);
        float strong   = step(u_dogThreshold, abs(nDog));

        cosine *= forward;// * sameSign;// * strong;

        float take = step(maxScore, cosine);

        maxScore = mix(maxScore, cosine, take);
        bestDir  = mix(bestDir, float(i), take);
    }

    vec3 scoreRGB = packUnorm24(maxScore);

    outColor = vec4(
        bestDir / 255.0, // direction index
        scoreRGB.r,
        scoreRGB.g,
        scoreRGB.b
    );
}
`;function a_(e){const t=e-1;return t*t*t+1}function ma(e){const t=typeof e=="string"&&e.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return t?[parseFloat(t[1]),t[2]||"px"]:[e,"px"]}function l_(e,{delay:t=0,duration:n=400,easing:r=a_,x:s=0,y:i=0,opacity:a=0}={}){const o=getComputedStyle(e),l=+o.opacity,u=o.transform==="none"?"":o.transform,f=l*(1-a),[h,c]=ma(s),[d,m]=ma(i);return{delay:t,duration:n,easing:r,css:(_,v)=>`
			transform: ${u} translate(${(1-_)*h}${c}, ${(1-_)*d}${m});
			opacity: ${l-f*v}`}}class Ei{static OFFSETS=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]];neighborXOffset;neighborYOffset;score;constructor(t,n,r,s){const i=t&255,[a,o]=Ei.OFFSETS[i];this.neighborXOffset=a,this.neighborYOffset=o;const l=(n&255)<<16|(r&255)<<8|(s&255)<<0;this.score=l/16777215}}class xu{static unpackFloat32FromRGBA8(t,n,r,s){const i=(t&255)<<24|(n&255)<<16|(r&255)<<8|(s&255)<<0,a=new ArrayBuffer(4),o=new DataView(a);return o.setUint32(0,i>>>0,!1),o.getFloat32(0,!1)}static unpackUnorm2x16FromRGBA8(t,n,r,s){const i=(t&255)<<24|(n&255)<<16|(r&255)<<8|(s&255)<<0,a=i>>>16&65535,o=i&65535;return{rg:a/65535*2-1,ba:o/65535*2-1}}}class _a{value;constructor(t,n,r,s){this.value=xu.unpackFloat32FromRGBA8(t,n,r,s)}static calculateGaussianWeights(t,n){const r=new Float32Array(n),s=Math.floor(n/2),i=t*t;for(let a=-s;a<=s;a++){const o=Math.exp(-(a*a)/(2*i));r[a+s]=o}return r}}class u_{resetCount;remaining;action;constructor(t,n){this.resetCount=t,this.remaining=t,this.action=n}tick(){this.remaining--,this.remaining<=0&&(this.remaining=this.resetCount,this.action())}}class c_{constructor(t,n){this.bucketCount=t,this.size=n,this.buckets=new Array(t).fill(0),this.scale=new Array(t).fill(0),this.values=new Array(n)}buckets;scale;values;minValue=Number.POSITIVE_INFINITY;maxValue=Number.NEGATIVE_INFINITY;valueIndex=0;reset(t){this.buckets.fill(0),this.scale.fill(0),t!==this.size&&(this.size=t,this.values=new Array(t)),this.values.fill(0),this.minValue=Number.POSITIVE_INFINITY,this.maxValue=Number.NEGATIVE_INFINITY,this.valueIndex=0}addValue(t){if(this.valueIndex>=this.size)throw new Error("Histogram is full");this.values[this.valueIndex++]=t,t<this.minValue&&(this.minValue=t),t>this.maxValue&&(this.maxValue=t)}calculate(){if(this.valueIndex===0)return;if(this.minValue===this.maxValue){this.buckets[0]=this.valueIndex,this.scale[0]=1;return}const t=1/(this.maxValue-this.minValue);for(let s=0;s<this.valueIndex;s++){const i=this.values[s];let a=Math.floor((i-this.minValue)*t*(this.bucketCount-1));a<0&&(a=0),a>=this.bucketCount&&(a=this.bucketCount-1),this.buckets[a]++}let n=0;const r=1/this.valueIndex;for(let s=0;s<this.bucketCount;s++)n+=this.buckets[s],this.scale[s]=n*r}getPercentile(t){if(this.valueIndex===0)return 0;t=Math.min(Math.max(t,0),1);for(let n=0;n<this.bucketCount;n++)if(this.scale[n]>=t){const r=n/(this.bucketCount-1);return this.minValue+r*(this.maxValue-this.minValue)}return this.maxValue}}class f_ extends xn{constructor(t,n){super(t,n),this.sobelPassSettings=n,this.sobelGradientsProgramInfo=this.createProgramInfo(ha),this.sobelGradientsRenderTarget=W.createRGBA8(t),this.sobelGradientsProgramInfo=this.createProgramInfo(ha),this.sobelGradientsRenderTarget=W.createRGBA8(t),this.sobelVectorsProgramInfo=this.createProgramInfo(s_),this.sobelVectorsRenderTarget=W.createRGBA8(t),this.dogProgramInfo=this.createProgramInfo(i_),this.dogRenderTarget=W.createRGBA8(t),this.checkAndUpdateGaussianWeights(),this.dogCountdown=new u_(30,this.recalculateDoGPercentiles.bind(this)),this.neighborScoringProgramInfo=this.createProgramInfo(o_),this.neighborScoringRenderTarget=W.createRGBA8(t),this.debugProgramInfo=this.createProgramInfo(this.debugFragmentShaderSource),this.debugRenderTarget=W.createRGBA8(t),this.debugQuadBufferInfo=bl.createXYQuadBufferInfo(t)}sobelGradientsProgramInfo;sobelGradientsRenderTarget;sobelGradientsRGBAData=new Uint8Array;sobelVectorsProgramInfo;sobelVectorsRenderTarget;dogProgramInfo;dogRenderTarget;currentSigmaSmall=-1;currentSigmaLarge=-1;currentSigmaSmallWeights=new Float32Array(19);currentSigmaLargeWeights=new Float32Array(19);dogRGBAData=new Uint8Array;dogHistogram=new c_(256,0);dogCountdown;dogPercentileThreshold=0;neighborScoringProgramInfo;neighborScoringRenderTarget;neighborScoringRGBAData=new Uint8Array;continuityScores=[];metadata=[];debugProgramInfo;debugRenderTarget;debugQuadBufferInfo;debugFragmentShaderSource=`
#version 300 es
precision highp float;

in vec2 v_uv;
uniform sampler2D u_input;

out vec4 outColor;

void main() {
outColor = texture(u_input, v_uv);
}
`;applyInternal(t,n){if(!t.isR8)throw new Error("StructurePass expects R8 target");return this.executeProgram(this.sobelGradientsProgramInfo,t,this.sobelGradientsRenderTarget),this.executeProgram(this.sobelVectorsProgramInfo,this.sobelGradientsRenderTarget,this.sobelVectorsRenderTarget),this.executeDifferenceOfGaussians(),this.executeNeighborScoring(),this.buildMetadata(),this.drawJunk(this.neighborScoringRenderTarget.framebufferInfo.width,this.neighborScoringRenderTarget.framebufferInfo.height),this.dogRenderTarget}drawJunk(t,n){const r=new Float32Array(this.metadata.length),s=this.metadata.slice().filter(i=>i.score>.1).sort((i,a)=>a.score-a.score);for(let i=0;i<5e4;i++){let a=s[i],o=100;for(;o-- >0&&a&&a.score>.1;)r[a.index]=1,a=this.metadata[a.nextContinuityScoreIndex]}this.drawLumaArray(this.gl,this.debugProgramInfo,this.debugRenderTarget,t,n,r)}checkAndUpdateGaussianWeights(){const t=this.settings;this.currentSigmaSmall!==t.sigmaSmall&&(this.currentSigmaSmall=t.sigmaSmall,this.currentSigmaSmallWeights=_a.calculateGaussianWeights(t.sigmaSmall,19)),this.currentSigmaLarge!==t.sigmaLarge&&(this.currentSigmaLarge=t.sigmaLarge,this.currentSigmaLargeWeights=_a.calculateGaussianWeights(t.sigmaLarge,19))}executeDifferenceOfGaussians(){this.settings.uniforms.u_sigmaSmallWeights=this.currentSigmaSmallWeights,this.settings.uniforms.u_sigmaLargeWeights=this.currentSigmaLargeWeights,this.executeProgram(this.dogProgramInfo,this.sobelGradientsRenderTarget,this.dogRenderTarget),this.dogCountdown.tick()}executeNeighborScoring(){this.settings.uniforms.u_dogThreshold=this.dogPercentileThreshold,this.settings.uniforms.u_dogs=this.dogRenderTarget.texture,this.executeProgram(this.neighborScoringProgramInfo,this.sobelVectorsRenderTarget,this.neighborScoringRenderTarget);const t=this.neighborScoringRenderTarget.framebufferInfo.width,n=this.neighborScoringRenderTarget.framebufferInfo.height;this.neighborScoringRGBAData=this.readRGBA8Framebuffer(this.gl,this.neighborScoringRenderTarget.framebufferInfo.framebuffer,t,n,this.neighborScoringRGBAData),this.continuityScores.length<t*n&&(this.continuityScores=new Array(t*n));for(let r=0;r<t*n;r++){const s=r*4,i=this.neighborScoringRGBAData[s+0],a=this.neighborScoringRGBAData[s+1],o=this.neighborScoringRGBAData[s+2],l=this.neighborScoringRGBAData[s+3];this.continuityScores[r]=new Ei(i,a,o,l)}}recalculateDoGPercentiles(){const t=this.dogRenderTarget.framebufferInfo.width,n=this.dogRenderTarget.framebufferInfo.height;this.dogRGBAData=this.readRGBA8Framebuffer(this.gl,this.dogRenderTarget.framebufferInfo.framebuffer,t,n,this.dogRGBAData),this.dogHistogram.reset(t*n);for(let r=0;r<t*n;r++){const s=r*4,i=this.dogRGBAData[s+0],a=this.dogRGBAData[s+1],o=this.dogRGBAData[s+2],l=this.dogRGBAData[s+3],u=xu.unpackFloat32FromRGBA8(i,a,o,l);this.dogHistogram.addValue(u)}this.dogHistogram.calculate(),this.dogPercentileThreshold=this.dogHistogram.getPercentile(.1)}buildMetadata(){const t=this.neighborScoringRenderTarget.framebufferInfo.width,n=this.neighborScoringRenderTarget.framebufferInfo.height;this.metadata.length<t*n&&(this.metadata=new Array(t*n)),this.sobelGradientsRGBAData=this.readRGBA8Framebuffer(this.gl,this.sobelGradientsRenderTarget.framebufferInfo.framebuffer,t,n,this.sobelGradientsRGBAData);for(let r=0;r<t*n;r++){const s=r*4,i=this.sobelGradientsRGBAData[s+2],a=this.sobelGradientsRGBAData[s+3],o=(i<<8|a)/65535,l=this.continuityScores[r];let u=-1;if(l.neighborXOffset!==0||l.neighborYOffset!==0){const f=r%t,h=r/t|0,c=f+l.neighborXOffset,d=h+l.neighborYOffset;c>=0&&c<t&&d>=0&&d<n&&(u=d*t+c)}this.metadata[r]={index:r,continuityScore:l,nextContinuityScoreIndex:u,magnitude:o,score:l.score*o}}}readRGBA8Framebuffer(t,n,r,s,i){return(!i||i.length<r*s*4)&&(i=new Uint8Array(r*s*4)),t.bindFramebuffer(t.FRAMEBUFFER,n),t.pixelStorei(t.PACK_ALIGNMENT,1),t.readPixels(0,0,r,s,t.RGBA,t.UNSIGNED_BYTE,i),t.bindFramebuffer(t.FRAMEBUFFER,null),i}drawLumaArray(t,n,r,s,i,a){const o=new Uint8Array(s*i*4);for(let l=0;l<s*i;l++){const u=Math.max(0,Math.min(1,a[l]))*255,f=l*4;o[f+0]=u,o[f+1]=u,o[f+2]=u,o[f+3]=255}t.bindTexture(t.TEXTURE_2D,r.texture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,s,i,0,t.RGBA,t.UNSIGNED_BYTE,o),t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(0,0,s,i),t.useProgram(n.program),cu(t,n,this.quadBufferInfo),xi(n,{u_input:r.texture}),fu(t,this.quadBufferInfo)}}class d_ extends bn{get sigmaSmall(){return this.uniforms.u_sigmaSmall}set sigmaSmall(t){this.uniforms.u_sigmaSmall=t}get sigmaLarge(){return this.uniforms.u_sigmaLarge}set sigmaLarge(t){this.uniforms.u_sigmaLarge=t}}const h_=`#version 300 es
precision highp float;

in vec2 v_uv;

/*
  u_input is always bound by the pipeline
  and represents the CURRENT frame.
*/
uniform sampler2D u_input;

uniform sampler2D u_frame1;
uniform sampler2D u_frame2;
uniform sampler2D u_frame3;
uniform sampler2D u_frame4;

out vec4 outColor;

/*
  Exact median of 5 values.
  Deterministic, branchless.
*/
float median5(
    float v0,
    float v1,
    float v2,
    float v3,
    float v4
) {
    float a = min(v0, v1);
    float b = max(v0, v1);
    float c = min(v2, v3);
    float d = max(v2, v3);

    float e = max(a, c);
    float f = min(b, d);

    float g = min(e, f);
    float h = max(e, f);

    return max(min(h, v4), g);
}

void main() {
    float value0 = texture(u_input,  v_uv).r;
    float value1 = texture(u_frame1, v_uv).r;
    float value2 = texture(u_frame2, v_uv).r;
    float value3 = texture(u_frame3, v_uv).r;
    float value4 = texture(u_frame4, v_uv).r;

    float medianValue =
        median5(value0, value1, value2, value3, value4);

    outColor = vec4(medianValue, medianValue, medianValue, 1.0);
}
`;class m_ extends xn{programInfo;outputRenderTarget;history=[];historyWriteIndex=0;historyInitialized=!1;constructor(t,n){super(t,n),this.programInfo=this.createProgramInfo(h_),this.outputRenderTarget=W.createR8(t),this.history=[W.createR8(t),W.createR8(t),W.createR8(t),W.createR8(t)]}ensureHistorySized(t,n){for(const r of this.history)(r.framebufferInfo.width!==t||r.framebufferInfo.height!==n)&&r.resize(t,n)}copyToHistory(t){const n=this.gl,r=this.history[this.historyWriteIndex];n.bindFramebuffer(n.READ_FRAMEBUFFER,t.framebufferInfo.framebuffer),n.bindTexture(n.TEXTURE_2D,r.texture),n.copyTexSubImage2D(n.TEXTURE_2D,0,0,0,0,0,t.framebufferInfo.width,t.framebufferInfo.height),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),this.historyWriteIndex=(this.historyWriteIndex+1)%this.history.length}seedHistory(t){for(let n=0;n<this.history.length;n++)this.historyWriteIndex=n,this.copyToHistory(t);this.historyInitialized=!0}applyInternal(t,n){if(!t.isR8)throw new Error("TemporalPass expects R8 or RGBA8 render targets");return this.ensureHistorySized(t.framebufferInfo.width,t.framebufferInfo.height),(this.outputRenderTarget.framebufferInfo.width!==t.framebufferInfo.width||this.outputRenderTarget.framebufferInfo.height!==t.framebufferInfo.height)&&this.outputRenderTarget.resize(t.framebufferInfo.width,t.framebufferInfo.height),this.historyInitialized||this.seedHistory(t),this.settings.uniforms.u_frame1=this.history[0].texture,this.settings.uniforms.u_frame2=this.history[1].texture,this.settings.uniforms.u_frame3=this.history[2].texture,this.settings.uniforms.u_frame4=this.history[3].texture,this.executeProgram(this.programInfo,t,n?null:this.outputRenderTarget),this.copyToHistory(t),this.outputRenderTarget}}class __ extends bn{}const v_=`#version 300 es
precision highp float;

in vec2 v_uv;

uniform sampler2D u_input;
uniform vec2 u_corners[4];
uniform float u_thickness;

out vec4 outColor;

float segmentDistance(vec2 p, vec2 a, vec2 b) {
    vec2 ab = b - a;
    float t = clamp(dot(p - a, ab) / dot(ab, ab), 0.0, 1.0);
    vec2 closest = a + t * ab;
    return length(p - closest);
}

void main() {
    vec4 base = texture(u_input, v_uv);

    vec2 p = v_uv;
    float d0 = segmentDistance(p, u_corners[0], u_corners[1]);
    float d1 = segmentDistance(p, u_corners[1], u_corners[2]);
    float d2 = segmentDistance(p, u_corners[2], u_corners[3]);
    float d3 = segmentDistance(p, u_corners[3], u_corners[0]);

    float minDist = min(min(d0, d1), min(d2, d3));

    float edge = step(u_thickness, minDist);
    float mask = 1.0 - edge;

    outColor = mix(base, vec4(1.0, 1.0, 1.0, 1.0), mask);
}
`;class p_ extends xn{boxProgramInfo;outputRenderTarget;pixelBuffer=null;pixelChannels=0;lastBox=null;constructor(t,n){super(t,n),this.boxProgramInfo=this.createProgramInfo(v_),this.outputRenderTarget=W.createRGBA8(t)}ensurePixelBuffer(t,n,r){const s=t*n*r;(!this.pixelBuffer||this.pixelBuffer.length!==s)&&(this.pixelBuffer=new Uint8Array(s)),this.pixelChannels=r}readPixelsToBuffer(t){const n=t.framebufferInfo.width,r=t.framebufferInfo.height,s=t.isR8,i=s?this.gl.RED:this.gl.RGBA,a=s?1:4;return this.ensurePixelBuffer(n,r,a),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,t.framebufferInfo.framebuffer),this.gl.readPixels(0,0,n,r,i,this.gl.UNSIGNED_BYTE,this.pixelBuffer),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),{width:n,height:r}}sampleMax3x3(t,n,r,s){if(!this.pixelBuffer)return 0;const i=Math.round(t),a=Math.round(n);let o=0;for(let l=-1;l<=1;l++)for(let u=-1;u<=1;u++){const f=Math.max(0,Math.min(r-1,i+u)),h=Math.max(0,Math.min(s-1,a+l)),d=((s-1-h)*r+f)*this.pixelChannels,m=this.pixelBuffer[d]/255;m>o&&(o=m)}return o}findRayHits(t,n,r,s,i){const a=(t-1)*.5,o=(n-1)*.5,l=[];for(let u=0;u<s;u++){const f=u/s*Math.PI*2,h=Math.cos(f),c=Math.sin(f),d=h>0?(t-1-a)/h:h<0?-a/h:1/0,m=c>0?(n-1-o)/c:c<0?-o/c:1/0,_=Math.min(d,m);if(isFinite(_))for(let v=_;v>=0;v-=i){const x=a+h*v,E=o+c*v;if(this.sampleMax3x3(x,E,t,n)>=r){l.push({x:x/(t-1),y:E/(n-1)});break}}}return l}computeOBBCorners(t,n){if(t.length<4)return[{x:.5-.25,y:.5-.25},{x:.5+.25,y:.5-.25},{x:.5+.25,y:.5+.25},{x:.5-.25,y:.5+.25}];let r=0,s=0;for(const y of t)r+=y.x,s+=y.y;r/=t.length,s/=t.length;let i=0,a=0,o=0;for(const y of t){const T=y.x-r,C=y.y-s;i+=T*T,a+=T*C,o+=C*C}const l=i+o,u=i*o-a*a,f=Math.sqrt(Math.max(0,l*l-4*u)),h=(l+f)*.5;let c=a,d=h-i;const m=Math.hypot(c,d)||1;c/=m,d/=m;const _=-d,v=c,x=[],E=[];for(const y of t){const T=y.x-r,C=y.y-s;x.push(T*c+C*d),E.push(T*_+C*v)}x.sort((y,T)=>y-T),E.sort((y,T)=>y-T);const g=Math.floor(x.length*Math.min(Math.max(n,0),.45)),R=x[g],b=x[x.length-1-g],A=E[g],F=E[E.length-1-g],P=[{x:r+R*c+A*_,y:s+R*d+A*v},{x:r+b*c+A*_,y:s+b*d+A*v},{x:r+b*c+F*_,y:s+b*d+F*v},{x:r+R*c+F*_,y:s+R*d+F*v}];for(const y of P)y.x=Math.max(0,Math.min(1,y.x)),y.y=Math.max(0,Math.min(1,y.y));return P}applyInternal(t,n){const r=this.settings,{width:s,height:i}=this.readPixelsToBuffer(t),a=this.findRayHits(s,i,r.threshold,Math.max(32,r.rayCount),r.step),o=this.computeOBBCorners(a,r.trimFraction);return this.lastBox={corners:o},this.settings.uniforms.u_corners=[o[0].x,1-o[0].y,o[1].x,1-o[1].y,o[2].x,1-o[2].y,o[3].x,1-o[3].y],this.settings.uniforms.u_thickness=1.5/Math.max(s,i),this.settings.uniforms.u_input=t.texture,this.executeProgram(this.boxProgramInfo,t,n?null:this.outputRenderTarget),this.outputRenderTarget}}class x_ extends bn{_threshold=.2;_rayCount=64;_step=.5;_trimFraction=.12;_angleThreshold=0;_distanceThreshold=0;get threshold(){return this._threshold}set threshold(t){this._threshold=t}get rayCount(){return this._rayCount}set rayCount(t){this._rayCount=t}get step(){return this._step}set step(t){this._step=t}get trimFraction(){return this._trimFraction}set trimFraction(t){this._trimFraction=t}get angleThreshold(){return this._angleThreshold}set angleThreshold(t){this._angleThreshold=t}get distanceThreshold(){return this._distanceThreshold}set distanceThreshold(t){this._distanceThreshold=t}}class va extends Km{passes;passMap;rayBoxPass;constructor(t){super(t);const n=new e_(this.gl),r=new r_;r.flipX=!1,r.flipY=!1;const s=new n_(this.gl,r),i=new __;i.enabled=!0;const a=new m_(this.gl,i),o=new Zm;o.kernelRadius=2,o.sigmaSpatial=2,o.sigmaRange=.1;const l=new Qm(this.gl,o),u=new d_;u.sigmaSmall=1.4,u.sigmaLarge=2.8;const f=new f_(this.gl,u),h=new x_;h.threshold=.12,h.rayCount=64,h.step=.5,h.trimFraction=.12,this.rayBoxPass=new p_(this.gl,h),this.passes=[{id:"rec709-luma",label:"Rec709 Luma",required:!0,pass:n},{id:"orientation",label:"Orientation",required:!1,pass:s},{id:"temporal",label:"Temporal Median",required:!1,pass:a},{id:"bilateral",label:"Bilateral",required:!1,pass:l},{id:"sobel",label:"Structure",required:!1,pass:f},{id:"ray-box",label:"Ray Box",required:!1,pass:this.rayBoxPass}],this.passMap=new Map(this.passes.map(c=>[c.id,c]));for(const c of this.passes)this.addPass(c.pass)}getPass(t){return this.passMap.get(t)?.pass}postprocess(){return{box:this.rayBoxPass.lastBox}}}class an{constructor(t){this.mediaStreamTrack=t,this.imageCapture=new ImageCapture(t)}static _imageCaptureContexts=new Map;static _initialized=!1;static get imageCaptureContexts(){if(!an._initialized)throw new Error("ImageCaptureContext not initialized. Call ImageCaptureContext.initialize() first.");return an._imageCaptureContexts}imageCapture;static async initialize(){await this.refreshVideoTracks(),this._initialized=!0}static async refreshVideoTracks(){await navigator.mediaDevices.getUserMedia({video:!0});const n=(await navigator.mediaDevices.enumerateDevices()).filter(s=>s.kind==="videoinput"),r=new Set;for(const s of n){const a=(await navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:s.deviceId}}})).getVideoTracks()[0];r.add(a.id),this._imageCaptureContexts.has(a.id)||this._imageCaptureContexts.set(a.id,new an(a))}for(const[s]of this._imageCaptureContexts)r.has(s)||this._imageCaptureContexts.delete(s)}}var b_=ne('<button type="button" role="tab"> </button>'),g_=ne('<div class="passBar" role="tablist" aria-label="Pipeline passes"></div>');function E_(e,t){pe(t,!1);let n=Y(t,"passes",24,()=>[]),r=Y(t,"selectedPassId",8);const s=Os();Ve();var i=g_();Es(i,5,n,a=>a.id,(a,o)=>{var l=b_();let u;var f=U(l);Se(()=>{u=Rs(l,1,"passButton",null,u,{passButtonActive:r()===p(o).id}),nr(l,"aria-selected",(ke(r()),p(o),Fe(()=>r()===p(o).id))),Je(f,(p(o),Fe(()=>p(o).label)))}),sn("click",l,()=>s("select",{passId:p(o).id})),L(a,l)}),L(e,i),xe()}var y_=ne('<label class="setting"><div class="settingLabel"> </div> <div class="settingControl sliderControl svelte-2wv2v5"><div class="sliderShell svelte-2wv2v5"><div class="sliderTrack svelte-2wv2v5"><input class="sliderInput svelte-2wv2v5" type="range"/></div> <div class="settingValue svelte-2wv2v5"> </div></div></div></label>');function Me(e,t){pe(t,!1);let n=Y(t,"label",8),r=Y(t,"min",8),s=Y(t,"max",8),i=Y(t,"step",8),a=Y(t,"value",8);const o=Os();Ve();var l=y_(),u=U(l),f=U(u),h=V(u,2),c=U(h),d=U(c),m=U(d),_=V(d,2),v=U(_);Se(()=>{Je(f,n()),nr(m,"min",r()),nr(m,"max",s()),nr(m,"step",i()),sf(m,a()),Je(v,a())}),sn("input",m,x=>o("input",{value:Number(x.currentTarget.value)})),L(e,l),xe()}var R_=ne('<label class="setting toggleSetting"><div class="settingLabel"> </div> <div class="settingControl"><input type="checkbox"/></div></label>');function ct(e,t){pe(t,!1);let n=Y(t,"label",8),r=Y(t,"checked",8);const s=Os();Ve();var i=R_(),a=U(i),o=U(a),l=V(a,2),u=U(l);Se(()=>{Je(o,n()),of(u,r())}),sn("change",u,f=>s("change",{checked:f.currentTarget.checked})),L(e,i),xe()}var S_=ne('<div class="settings"><!> <!> <!> <!></div>');function A_(e,t){pe(t,!1);let n=Y(t,"settings",12),r=Y(t,"required",8,!1);const s=5,i=2,a=.5,o=s/3;let l=N(n().enabled),u=N(n().kernelRadius),f=N(n().sigmaSpatial),h=N(n().sigmaRange);function c(y,T,C){return Math.max(T,Math.min(C,y))}function d(y){return Math.ceil(3*y)}function m(y){return y/3}function _(y){S(l,y),n(n().enabled=y,!0)}function v(y){const T=c(Math.round(y),i,s),C=m(T),K=Math.min(n().sigmaSpatial,C);S(u,T),S(f,K),n(n().kernelRadius=T,!0),n(n().sigmaSpatial=K,!0)}function x(y){const T=c(y,a,o),C=d(T),K=c(C,i,s);S(f,T),S(u,K),n(n().sigmaSpatial=T,!0),n(n().kernelRadius=K,!0)}function E(y){S(h,y),n(n().sigmaRange=y,!0)}Nt(()=>ke(n()),()=>{n()&&(S(l,n().enabled),S(u,n().kernelRadius),S(f,n().sigmaSpatial),S(h,n().sigmaRange))}),kt(),Ve();var g=S_(),R=U(g);{var b=y=>{ct(y,{label:"Enabled",get checked(){return p(l)},$$events:{change:T=>_(T.detail.checked)}})};ie(R,y=>{r()||y(b)})}var A=V(R,2);Me(A,{label:"Kernel Radius",min:i,max:s,step:1,get value(){return p(u)},$$events:{input:y=>v(y.detail.value)}});var F=V(A,2);Me(F,{label:"Sigma Spatial",min:a,max:o,step:.1,get value(){return p(f)},$$events:{input:y=>x(y.detail.value)}});var P=V(F,2);Me(P,{label:"Sigma Range",min:.01,max:.5,step:.01,get value(){return p(h)},$$events:{input:y=>E(y.detail.value)}}),L(e,g),xe()}var T_=ne('<div class="settings"><div class="settingsEmpty">Rec709 is required and has no settings.</div></div>');function F_(e){var t=T_();L(e,t)}var w_=ne('<div class="settings"><!> <!> <!></div>');function I_(e,t){pe(t,!1);let n=Y(t,"settings",12),r=Y(t,"required",8,!1),s=N(n().enabled),i=N(n().sigmaSmall),a=N(n().sigmaLarge);function o(_){S(s,_),n(n().enabled=_,!0)}function l(_){S(i,_),n(n().sigmaSmall=_,!0)}function u(_){S(a,_),n(n().sigmaLarge=_,!0)}Nt(()=>ke(n()),()=>{n()&&(S(s,n().enabled),S(i,n().sigmaSmall),S(a,n().sigmaLarge))}),kt(),Ve();var f=w_(),h=U(f);{var c=_=>{ct(_,{label:"Enabled",get checked(){return p(s)},$$events:{change:v=>o(v.detail.checked)}})};ie(h,_=>{r()||_(c)})}var d=V(h,2);Me(d,{label:"Sigma Small",min:1,max:1.8,step:.05,get value(){return p(i)},$$events:{input:_=>l(_.detail.value)}});var m=V(d,2);Me(m,{label:"Sigma Large",min:2,max:3,step:.05,get value(){return p(a)},$$events:{input:_=>u(_.detail.value)}}),L(e,f),xe()}var P_=ne('<div class="settings"><!> <!></div>');function B_(e,t){pe(t,!1);let n=Y(t,"settings",12),r=Y(t,"required",8,!1),s=N(n().enabled),i=N(n().threshold);function a(c){S(s,c),n(n().enabled=c,!0)}function o(c){S(i,c),n(n().threshold=c,!0)}Nt(()=>ke(n()),()=>{n()&&(S(s,n().enabled),S(i,n().threshold))}),kt(),Ve();var l=P_(),u=U(l);{var f=c=>{ct(c,{label:"Enabled",get checked(){return p(s)},$$events:{change:d=>a(d.detail.checked)}})};ie(u,c=>{r()||c(f)})}var h=V(u,2);Me(h,{label:"Threshold",min:0,max:.5,step:.005,get value(){return p(i)},$$events:{input:c=>o(c.detail.value)}}),L(e,l),xe()}var C_=ne('<div class="settings"><!> <div class="settingsEmpty">Uses last 4 frames (median). No tunable parameters.</div></div>');function D_(e,t){pe(t,!1);let n=Y(t,"settings",12),r=Y(t,"required",8,!1),s=N(n().enabled);function i(u){S(s,u),n(n().enabled=u,!0)}Nt(()=>ke(n()),()=>{n()&&S(s,n().enabled)}),kt(),Ve();var a=C_(),o=U(a);{var l=u=>{ct(u,{label:"Enabled",get checked(){return p(s)},$$events:{change:f=>i(f.detail.checked)}})};ie(o,u=>{r()||u(l)})}L(e,a),xe()}var M_=ne('<div class="settings"><!> <!> <!> <!> <!></div>');function N_(e,t){pe(t,!1);let n=Y(t,"settings",12),r=Y(t,"required",8,!1),s=N(n().enabled),i=N(n().threshold),a=N(n().rayCount),o=N(n().step),l=N(n().trimFraction);function u(b){S(s,b),n(n().enabled=b,!0)}function f(b){S(i,b),n(n().threshold=b,!0)}function h(b){S(a,b),n(n().rayCount=b,!0)}function c(b){S(o,b),n(n().step=b,!0)}function d(b){S(l,b),n(n().trimFraction=b,!0)}Nt(()=>ke(n()),()=>{n()&&(S(s,n().enabled),S(i,n().threshold),S(a,n().rayCount),S(o,n().step),S(l,n().trimFraction))}),kt(),Ve();var m=M_(),_=U(m);{var v=b=>{ct(b,{label:"Enabled",get checked(){return p(s)},$$events:{change:A=>u(A.detail.checked)}})};ie(_,b=>{r()||b(v)})}var x=V(_,2);Me(x,{label:"Threshold",min:0,max:.5,step:.005,get value(){return p(i)},$$events:{input:b=>f(b.detail.value)}});var E=V(x,2);Me(E,{label:"Ray Count",min:32,max:256,step:8,get value(){return p(a)},$$events:{input:b=>h(Math.round(b.detail.value))}});var g=V(E,2);Me(g,{label:"Step (px)",min:.25,max:5,step:.25,get value(){return p(o)},$$events:{input:b=>c(b.detail.value)}});var R=V(g,2);Me(R,{label:"Trim Fraction",min:0,max:.4,step:.01,get value(){return p(l)},$$events:{input:b=>d(b.detail.value)}}),L(e,m),xe()}var k_=ne('<div class="settings"><!> <!> <!></div>');function G_(e,t){pe(t,!1);let n=Y(t,"settings",12),r=Y(t,"required",8,!1),s=N(n().enabled),i=N(n().flipX),a=N(n().flipY);function o(_){S(s,_),n(n().enabled=_,!0)}function l(_){S(i,_),n(n().flipX=_,!0)}function u(_){S(a,_),n(n().flipY=_,!0)}Nt(()=>ke(n()),()=>{n()&&(S(s,n().enabled),S(i,n().flipX),S(a,n().flipY))}),kt(),Ve();var f=k_(),h=U(f);{var c=_=>{ct(_,{label:"Enabled",get checked(){return p(s)},$$events:{change:v=>o(v.detail.checked)}})};ie(h,_=>{r()||_(c)})}var d=V(h,2);ct(d,{label:"Flip X",get checked(){return p(i)},$$events:{change:_=>l(_.detail.checked)}});var m=V(d,2);ct(m,{label:"Flip Y",get checked(){return p(a)},$$events:{change:_=>u(_.detail.checked)}}),L(e,f),xe()}var L_=ne('<div class="fpsBadge svelte-1dp3x29" aria-label="Frames per second"> </div>');function U_(e,t){pe(t,!1);let n=N(0),r=0,s=performance.now();function i(){const u=performance.now();r+=1;const f=u-s;f>=500&&(S(n,Math.round(r*1e3/f)),r=0,s=u)}var a={measure:i},o=L_(),l=U(o);return Se(()=>Je(l,`${p(n)??""} fps`)),L(e,o),lf(t,"measure",i),xe(a)}var O_=ne('<div class="toast svelte-1fk2ial" role="status"> </div>');function V_(e,t){pe(t,!1);let n=Y(t,"message",8,""),r=Y(t,"open",12,!1),s=Y(t,"duration",8,2e3),i=N(null);Nt(()=>(ke(r()),p(i),ke(s())),()=>{r()&&(p(i)&&clearTimeout(p(i)),S(i,setTimeout(()=>r(!1),s())))}),kt();var a=ae(),o=oe(a);{var l=u=>{var f=O_(),h=U(f);Se(()=>Je(h,n())),Jc(3,f,()=>l_,()=>({y:10,duration:150})),L(u,f)};ie(o,u=>{r()&&u(l)})}L(e,a),xe()}const H_={"rec709-luma":{enabled:!0},orientation:{enabled:!0,flipX:!0,flipY:!1},temporal:{enabled:!0},bilateral:{enabled:!0,kernelRadius:2,sigmaSpatial:2,sigmaRange:.1},sobel:{enabled:!1,sigmaSmall:1.4,sigmaLarge:2.8},"ray-box":{enabled:!1}},z_={passes:H_},X_={"rec709-luma":{enabled:!0},orientation:{enabled:!0,flipX:!0,flipY:!1},temporal:{enabled:!0},bilateral:{enabled:!0,kernelRadius:2,sigmaSpatial:2,sigmaRange:.1},sobel:{enabled:!0,sigmaSmall:1.4,sigmaLarge:2.8},"ray-box":{enabled:!1}},$_={passes:X_};var q_=ne("<option> </option>"),Y_=ne("<option> </option>"),K_=ne('<div class="errorBanner svelte-1n46o8q" role="alert"> </div>'),W_=ne('<main class="app svelte-1n46o8q"><section class="controls svelte-1n46o8q"><div class="controlRow svelte-1n46o8q"><div class="sideSwitcher svelte-1n46o8q" role="group" aria-label="Side selector"><button type="button">Front</button> <button type="button">Rear</button></div> <!> <button class="exportButton svelte-1n46o8q" type="button">Export</button></div> <!></section> <section class="views svelte-1n46o8q"><div class="cameraPanel svelte-1n46o8q"><div class="cameraHeader svelte-1n46o8q"><div class="cameraTitle svelte-1n46o8q">Front</div> <select class="cameraSelect svelte-1n46o8q"><option disabled>Select inputâ¦</option><!></select></div> <canvas class="cameraCanvas svelte-1n46o8q"></canvas></div> <div class="cameraPanel svelte-1n46o8q"><div class="cameraHeader svelte-1n46o8q"><div class="cameraTitle svelte-1n46o8q">Rear</div> <select class="cameraSelect svelte-1n46o8q"><option disabled>Select inputâ¦</option><!></select></div> <canvas class="cameraCanvas svelte-1n46o8q"></canvas></div></section> <!> <!> <!></main>');function j_(e,t){pe(t,!1);const n={"rec709-luma":F_,bilateral:A_,sobel:I_,"magnatude-gate":B_,temporal:D_,"ray-box":N_,orientation:G_};let r=N(""),s=new Map,i=N([]),a=N(""),o=N(""),l=N("front"),u=N(null),f=N(null),h=N(null),c=N(null),d=N([]),m=N(null),_=!1,v=!1,x=N(null),E=N(!1),g=N("");function R(){S(i,Array.from(s.entries()).map(([w,I])=>({id:w,label:`${I.mediaStreamTrack.label||"Camera"} (${w})`})))}async function b(){await an.initialize(),s=an.imageCaptureContexts,R(),!p(a)&&p(i)[0]&&S(a,p(i)[0].id),!p(o)&&p(i)[1]&&S(o,p(i)[1].id),!p(o)&&p(i)[0]&&S(o,p(i)[0].id)}function A(w,I){const M=I?.getPass(w);return M?M.settings:null}function F(w,I){const M=I?.passes??{};for(const H of w.passes){const k=M[H.id];if(k){typeof k.enabled=="boolean"&&(H.pass.enabled=k.enabled);for(const[Ht,Or]of Object.entries(k))Ht!=="enabled"&&Ht in H.pass.settings&&(H.pass.settings[Ht]=Or)}}}function P(w){const I={};for(const M of w.passes){const H={enabled:M.pass.enabled},k=M.pass.settings;switch(M.id){case"bilateral":H.kernelRadius=k.kernelRadius,H.sigmaSpatial=k.sigmaSpatial,H.sigmaRange=k.sigmaRange;break;case"sobel":H.kernelRadius=k.kernelRadius,H.directionBias=k.directionBias,H.edgeGain=k.edgeGain,H.minEdge=k.minEdge;break;case"magnatude-gate":H.threshold=k.threshold;break;case"temporal":break;case"orientation":H.flipX=k.flipX,H.flipY=k.flipY;break;case"ray-box":H.threshold=k.threshold,H.rayCount=k.rayCount,H.step=k.step,H.trimFraction=k.trimFraction;break}I[M.id]=H}return{passes:I}}async function y(w){const I=p(w==="front"?h:c);if(!I)return;const M=JSON.stringify(P(I),null,2);await navigator.clipboard.writeText(M),S(g,`Exported ${w} settings to clipboard`),S(E,!0)}async function T(w,I){if(!w||!I)return;const M=s.get(I);if(!M)return;const H=await M.imageCapture.grabFrame();try{await w.render(H)}finally{H.close()}}async function C(){if(_){if(v){p(x)?.measure(),requestAnimationFrame(()=>{C()});return}v=!0;try{p(x)?.measure(),await T(p(h),p(a)),await T(p(c),p(o)),S(m,null)}catch(w){S(m,w instanceof Error?w.message:String(w))}finally{v=!1,requestAnimationFrame(()=>{C()})}}}Ja(async()=>{try{if(await b(),!p(u)||!p(f)){S(m,"Canvas not available for one or both views.");return}S(h,new va(p(u))),S(c,new va(p(f))),p(h)&&F(p(h),z_),p(c)&&F(p(c),$_),S(d,p(h).passes),S(r,p(d)[0]?.id??""),_=!0,C()}catch(w){S(m,w instanceof Error?w.message:String(w))}}),cf(()=>{_=!1}),Ve();var K=W_(),Z=U(K),me=U(Z),be=U(me),Ie=U(be);let Xe;var $e=V(Ie,2);let qe;var pt=V(be,2);{let w=st(()=>p(d).map(I=>({id:I.id,label:I.label})));E_(pt,{get passes(){return p(w)},get selectedPassId(){return p(r)},$$events:{select:I=>S(r,I.detail.passId)}})}var Lt=V(pt,2),Ut=V(me,2);{var Ot=w=>{const I=st(()=>p(d).find(yn=>yn.id===p(r))),M=st(()=>p(I)?n[p(I).id]:null),H=st(()=>p(l)==="front"?p(h):p(c)),k=st(()=>p(I)?A(p(I).id,p(H)):null);var Ht=ae(),Or=oe(Ht);{var Su=yn=>{var Ti=ae(),Au=oe(Ti);{var Tu=zt=>{var Rn=ae(),Vr=oe(Rn);gt(Vr,()=>p(M),(Hr,zr)=>{zr(Hr,{get required(){return p(I).required},get settings(){return p(k)}})}),L(zt,Rn)},Fu=zt=>{var Rn=ae(),Vr=oe(Rn);{var Hr=Xt=>{var Sn=ae(),Xr=oe(Sn);gt(Xr,()=>p(M),($r,qr)=>{qr($r,{get required(){return p(I).required},get settings(){return p(k)}})}),L(Xt,Sn)},zr=Xt=>{var Sn=ae(),Xr=oe(Sn);{var $r=$t=>{var An=ae(),Yr=oe(An);gt(Yr,()=>p(M),(Kr,Wr)=>{Wr(Kr,{get required(){return p(I).required},get settings(){return p(k)}})}),L($t,An)},qr=$t=>{var An=ae(),Yr=oe(An);{var Kr=qt=>{var Tn=ae(),jr=oe(Tn);gt(jr,()=>p(M),(Qr,Zr)=>{Zr(Qr,{get required(){return p(I).required},get settings(){return p(k)}})}),L(qt,Tn)},Wr=qt=>{var Tn=ae(),jr=oe(Tn);{var Qr=Yt=>{var Fn=ae(),Jr=oe(Fn);gt(Jr,()=>p(M),(es,ts)=>{ts(es,{get required(){return p(I).required},get settings(){return p(k)}})}),L(Yt,Fn)},Zr=Yt=>{var Fn=ae(),Jr=oe(Fn);{var es=Kt=>{var wn=ae(),ns=oe(wn);gt(ns,()=>p(M),(rs,ss)=>{ss(rs,{get required(){return p(I).required},get settings(){return p(k)}})}),L(Kt,wn)},ts=Kt=>{var wn=ae(),ns=oe(wn);gt(ns,()=>p(M),(rs,ss)=>{ss(rs,{get required(){return p(I).required}})}),L(Kt,wn)};ie(Jr,Kt=>{p(I).id==="ray-box"?Kt(es):Kt(ts,!1)},!0)}L(Yt,Fn)};ie(jr,Yt=>{p(I).id==="temporal"?Yt(Qr):Yt(Zr,!1)},!0)}L(qt,Tn)};ie(Yr,qt=>{p(I).id==="magnatude-gate"?qt(Kr):qt(Wr,!1)},!0)}L($t,An)};ie(Xr,$t=>{p(I).id==="orientation"?$t($r):$t(qr,!1)},!0)}L(Xt,Sn)};ie(Vr,Xt=>{p(I).id==="sobel"?Xt(Hr):Xt(zr,!1)},!0)}L(zt,Rn)};ie(Au,zt=>{p(I).id==="bilateral"?zt(Tu):zt(Fu,!1)})}L(yn,Ti)};ie(Or,yn=>{p(I)&&p(M)&&p(k)&&yn(Su)})}L(w,Ht)};ie(Ut,w=>{p(r)&&w(Ot)})}var xt=V(Z,2),bt=U(xt),gn=U(bt),En=V(U(gn),2);Se(()=>{p(a),Di(()=>{p(i)})});var Vt=U(En);Vt.value=Vt.__value="";var qn=V(Vt);Es(qn,1,()=>p(i),w=>w.id,(w,I)=>{var M=q_(),H=U(M),k={};Se(()=>{Je(H,p(I).id),k!==(k=p(I).id)&&(M.value=(M.__value=p(I).id)??"")}),L(w,M)});var Q=V(gn,2);is(Q,w=>S(u,w),()=>p(u));var bu=V(bt,2),yi=U(bu),Ri=V(U(yi),2);Se(()=>{p(o),Di(()=>{p(i)})});var Ur=U(Ri);Ur.value=Ur.__value="";var gu=V(Ur);Es(gu,1,()=>p(i),w=>w.id,(w,I)=>{var M=Y_(),H=U(M),k={};Se(()=>{Je(H,p(I).id),k!==(k=p(I).id)&&(M.value=(M.__value=p(I).id)??"")}),L(w,M)});var Eu=V(yi,2);is(Eu,w=>S(f,w),()=>p(f));var Si=V(xt,2);{var yu=w=>{var I=K_(),M=U(I);Se(()=>Je(M,p(m))),L(w,I)};ie(Si,w=>{p(m)&&w(yu)})}var Ai=V(Si,2);is(U_(Ai,{$$legacy:!0}),w=>S(x,w),()=>p(x));var Ru=V(Ai,2);V_(Ru,{get message(){return p(g)},get open(){return p(E)},set open(w){S(E,w)},$$legacy:!0}),Se(()=>{Xe=Rs(Ie,1,"svelte-1n46o8q",null,Xe,{sideActive:p(l)==="front"}),qe=Rs($e,1,"svelte-1n46o8q",null,qe,{sideActive:p(l)==="rear"})}),sn("click",Ie,()=>S(l,"front")),sn("click",$e,()=>S(l,"rear")),sn("click",Lt,()=>y(p(l))),Vi(En,()=>p(a),w=>S(a,w)),Vi(Ri,()=>p(o),w=>S(o,w)),L(e,K),xe()}zc(j_,{target:document.getElementById("app")});
